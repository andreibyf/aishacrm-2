# ============================================
# AISHA CRM - PRODUCTION ENVIRONMENT
# VPS: 147.189.173.237 with Cloudflare Tunnel
# ============================================

# ============================================
# ENVIRONMENT
# ============================================
NODE_ENV=production

# ============================================
# FRONTEND URLS (Cloudflare Tunnel)
# ============================================
# Frontend domain
FRONTEND_URL=https://app.aishacrm.com

# CORS - Remove localhost:4000 if not needed for testing
ALLOWED_ORIGINS=https://app.aishacrm.com

# Backend API URL - includes /api because Cloudflare routes /api/* to backend
VITE_AISHACRM_BACKEND_URL=https://app.aishacrm.com/api

# ============================================
# DATABASE (Supabase PROD)
# ============================================
USE_SUPABASE_PROD=true
SUPABASE_URL=https://ehjlenywplgyiahgxkfj.supabase.co
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVoamxlbnl3cGxneWlhaGd4a2ZqIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1NjgxNTUyOCwiZXhwIjoyMDcyMzkxNTI4fQ.HV8eukAf3iSdYVK3-hsAvW1oZ2OdCYVcvewlH8CwHp0
SUPABASE_ANON_KEY=sb_publishable_P-agiWU11Auw3kUOFKrW6Q_Qs-_PkTi
SUPABASE_STORAGE_BUCKET=tenant-assets
DB_SSL=true

# Legacy DATABASE_URL (kept for compatibility, but USE_SUPABASE_PROD=true uses REST API)
DATABASE_URL=postgresql://postgres:Aml834VyYYH6humU@db.ehjlenywplgyiahgxkfj.supabase.co:5432/postgres?sslmode=require

# ============================================
# FRONTEND ENVIRONMENT VARIABLES
# (Injected at runtime by frontend-entrypoint.sh)
# ============================================
VITE_SUPABASE_URL=https://ehjlenywplgyiahgxkfj.supabase.co
VITE_SUPABASE_ANON_KEY=sb_publishable_P-agiWU11Auw3kUOFKrW6Q_Qs-_PkTi
VITE_SUPABASE_PUBLISHABLE_KEY=sb_publishable_P-agiWU11Auw3kUOFKrW6Q_Qs-_PkTi

# ============================================
# SECURITY & AUTHENTICATION
# ============================================
SESSION_SECRET=AVGI0HjFCxp20bick3qLODK3R5o7OVVu
JWT_SECRET=cd33072ecf1243bd58a29c46ae3c7a6030b5942a153ca008ae9ba63e8bf66ab165264dd944beca52b779ee333fa23272ceff4e62a1594e4d562dcc8ce5c51c8e

# ============================================
# INTRUSION DETECTION & RESPONSE (IDR)
# ============================================
IDR_ENABLED=false
IDR_DEBUG=false
# Whitelist: VPS IP + IPv6 range (bypasses all IDR checks)
IDR_WHITELIST_IPS=147.189.173.237,2a09:bac5:6c1a:2678::/64
# Emergency unblock secret (for /api/security/emergency-unblock)
IDR_EMERGENCY_SECRET=b96a53b6bedff123e2420c380c5f74a246756fd2eaa274a1f7174edfc1442ac5

# ============================================
# RATE LIMITING
# ============================================
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=500

# ============================================
# PRODUCTION SAFETY GUARDS
# ============================================
# Disabled to allow full production functionality
PRODUCTION_SAFETY_GUARD_ENABLED=false
ALLOW_PRODUCTION_WRITES=true

# ============================================
# REDIS CONNECTIONS (Docker network)
# ============================================
REDIS_MEMORY_URL=redis://redis-memory:6379
REDIS_CACHE_URL=redis://redis-cache:6379

# ============================================
# BRAID MCP SERVER
# ============================================
MCP_SECRET=wKi4ewnQWdAEKLfw8q7h6KgwtJxdjkdW
MCP_PORT=4002
# Docker network - backend container accessible as aishacrm-backend
CRM_BACKEND_URL=http://aishacrm-backend:3001
USE_DIRECT_SUPABASE_ACCESS=true

# ============================================
# SYSTEM LOGS & BATCHING
# ============================================
VITE_SYSTEM_LOG_LEVEL=ERROR
VITE_SYSTEM_LOG_BATCH_INTERVAL_MS=2000
VITE_SYSTEM_LOG_MAX_BATCH=25

# ============================================
# HEARTBEATS
# ============================================
VITE_USER_HEARTBEAT_INTERVAL_MS=90000
HEARTBEAT_INTERVAL_MS=120000
HEARTBEAT_ENABLED=true

# ============================================
# N8N AUTOMATION
# ============================================
N8N_USER=abyfield@4vdataconsulting.com
N8N_PASSWORD=MvjmY1g1heQe3vf2
# N8N_HOST=localhost
# N8N_WEBHOOK_URL=http://localhost:5678

# ============================================
# OPENAI (AI Features)
# ============================================
OPENAI_API_KEY=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

# ============================================
# EMAIL/SMS (Optional)
# ============================================
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=abyfield@4vdataconsulting.com
SMTP_PASS=RbM6Zn&3d=nX4rF>
# TWILIO_ACCOUNT_SID=your-sid
# TWILIO_AUTH_TOKEN=your-token

# ============================================
# NOTES
# ============================================
# - Cloudflare Tunnel routes:
#   - app.aishacrm.com → localhost:4000 (frontend)
#   - app.aishacrm.com/api/* → localhost:4001 (backend)
# - Docker containers:
#   - aishacrm-frontend: port 4000:3000
#   - aishacrm-backend: port 4001:3001
# - Backend URL includes /api path for Cloudflare routing
# - VITE_ variables are injected into frontend at runtime
