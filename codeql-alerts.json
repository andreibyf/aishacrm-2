[
  {
    "number": 393,
    "created_at": "2026-02-20T21:00:39Z",
    "updated_at": "2026-02-20T21:02:05Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/393",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/393",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/clear-text-logging",
      "severity": "error",
      "description": "Clear-text logging of sensitive information",
      "name": "js/clear-text-logging",
      "tags": ["external/cwe/cwe-312", "external/cwe/cwe-359", "external/cwe/cwe-532", "security"],
      "full_description": "Logging sensitive information without encryption or hashing can expose it to an attacker.",
      "help": "# Clear-text logging of sensitive information\nIf sensitive data is written to a log entry it could be exposed to an attacker who gains access to the logs.\n\nPotential attackers can obtain sensitive user data when the log output is displayed. Additionally that data may expose system information such as full path names, system information, and sometimes usernames and passwords.\n\n\n## Recommendation\nSensitive data should not be logged.\n\n\n## Example\nIn the example the entire process environment is logged using \\`console.info\\`. Regular users of the production deployed application should not have access to this much information about the environment configuration.\n\n\n```javascript\n// BAD: Logging cleartext sensitive data\nconsole.info(`[INFO] Environment: ${JSON.stringify(process.env)}`);\n\n```\nIn the second example the data that is logged is not sensitive.\n\n\n```javascript\nlet not_sensitive_data = { a: 1, b : 2} \n// GOOD: it is fine to log data that is not sensitive\nconsole.info(`[INFO] Some object contains: ${JSON.stringify(not_sensitive_data)}`);\n```\n\n## References\n* OWASP: [Insertion of Sensitive Information into Log File](https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/).\n* Common Weakness Enumeration: [CWE-312](https://cwe.mitre.org/data/definitions/312.html).\n* Common Weakness Enumeration: [CWE-359](https://cwe.mitre.org/data/definitions/359.html).\n* Common Weakness Enumeration: [CWE-532](https://cwe.mitre.org/data/definitions/532.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "This logs sensitive data returned by an access to passwordError as clear text."
      },
      "location": {
        "path": "backend/routes/users.js",
        "start_line": 1942,
        "end_line": 1942,
        "start_column": 66,
        "end_column": 79
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/393/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 392,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/392",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/392",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/weak-cryptographic-algorithm",
      "severity": "warning",
      "description": "Use of a broken or weak cryptographic algorithm",
      "name": "js/weak-cryptographic-algorithm",
      "tags": ["external/cwe/cwe-327", "external/cwe/cwe-328", "security"],
      "full_description": "Using broken or weak cryptographic algorithms can compromise security.",
      "help": "# Use of a broken or weak cryptographic algorithm\nUsing broken or weak cryptographic algorithms may compromise security guarantees such as confidentiality, integrity, and authenticity.\n\nMany cryptographic algorithms are known to be weak or flawed. The security guarantees of a system often rely on the underlying cryptography, so using a weak algorithm can have severe consequences. For example:\n\n* If a weak encryption algorithm is used, an attacker may be able to decrypt sensitive data.\n* If a weak hashing algorithm is used to protect data integrity, an attacker may be able to craft a malicious input that has the same hash as a benign one.\n* If a weak algorithm is used for digital signatures, an attacker may be able to forge signatures and impersonate legitimate users.\n\n## Recommendation\nEnsure that you use a strong, modern cryptographic algorithm. Use at least AES-128 or RSA-2048 for encryption, and SHA-2 or SHA-3 for secure hashing.\n\n\n## Example\nThe following code shows an example of using the builtin cryptographic library of NodeJS to encrypt some secret data. When creating a `Cipher` instance to encrypt the secret data with, you must specify the encryption algorithm to use. The first example uses DES, which is an older algorithm that is now considered weak. The second example uses AES, which is a strong modern algorithm.\n\n\n```javascript\nconst crypto = require('crypto');\n\nvar secretText = obj.getSecretText();\n\nconst desCipher = crypto.createCipher('des', key);\nlet desEncrypted = desCipher.write(secretText, 'utf8', 'hex'); // BAD: weak encryption\n\nconst aesCipher = crypto.createCipher('aes-128', key);\nlet aesEncrypted = aesCipher.update(secretText, 'utf8', 'hex'); // GOOD: strong encryption\n\n```\n\n## References\n* NIST, FIPS 140 Annex a: [ Approved Security Functions](http://csrc.nist.gov/publications/fips/fips140-2/fips1402annexa.pdf).\n* NIST, SP 800-131A: [ Transitions: Recommendation for Transitioning the Use of Cryptographic Algorithms and Key Lengths](http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf).\n* OWASP: [Rule - Use strong approved cryptographic algorithms](https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#rule---use-strong-approved-authenticated-encryption).\n* Common Weakness Enumeration: [CWE-327](https://cwe.mitre.org/data/definitions/327.html).\n* Common Weakness Enumeration: [CWE-328](https://cwe.mitre.org/data/definitions/328.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "A broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to TENANT_UUID.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to uuid.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to tenantUuid.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to tenantUuid.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to tenantUuid.\nA broken or weak cryptographic algorithm depends on sensitive data from an access to tenantUuid.\nA broken or weak cryptographic algorithm depends on [sensitive data from an a"
      },
      "location": {
        "path": "backend/lib/braid/registry.js",
        "start_line": 70,
        "end_line": 70,
        "start_column": 13,
        "end_column": 33
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/392/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 391,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/391",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/391",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/cors-misconfiguration-for-credentials",
      "severity": "error",
      "description": "CORS misconfiguration for credentials transfer",
      "name": "js/cors-misconfiguration-for-credentials",
      "tags": ["external/cwe/cwe-346", "external/cwe/cwe-639", "external/cwe/cwe-942", "security"],
      "full_description": "Misconfiguration of CORS HTTP headers allows for leaks of secret credentials.",
      "help": "# CORS misconfiguration for credentials transfer\nA server can send the `\"Access-Control-Allow-Credentials\"` CORS header to control when a browser may send user credentials in Cross-Origin HTTP requests.\n\nWhen the `Access-Control-Allow-Credentials` header is `\"true\"`, the `Access-Control-Allow-Origin` header must have a value different from `\"*\"` in order to make browsers accept the header. Therefore, to allow multiple origins for Cross-Origin requests with credentials, the server must dynamically compute the value of the `\"Access-Control-Allow-Origin\"` header. Computing this header value from information in the request to the server can therefore potentially allow an attacker to control the origins that the browser sends credentials to.\n\n\n## Recommendation\nWhen the `Access-Control-Allow-Credentials` header value is `\"true\"`, a dynamic computation of the `Access-Control-Allow-Origin` header must involve sanitization if it relies on user-controlled input.\n\nSince the `\"null\"` origin is easy to obtain for an attacker, it is never safe to use `\"null\"` as the value of the `Access-Control-Allow-Origin` header when the `Access-Control-Allow-Credentials` header value is `\"true\"`.\n\n\n## Example\nIn the example below, the server allows the browser to send user credentials in a Cross-Origin request. The request header `origins` controls the allowed origins for such a Cross-Origin request.\n\n\n```javascript\nvar https = require('https'),\n    url = require('url');\n\nvar server = https.createServer(function(){});\n\nserver.on('request', function(req, res) {\n    let origin = url.parse(req.url, true).query.origin;\n     // BAD: attacker can choose the value of origin\n    res.setHeader(\"Access-Control-Allow-Origin\", origin);\n    res.setHeader(\"Access-Control-Allow-Credentials\", true);\n\n    // ...\n});\n\n```\nThis is not secure, since an attacker can choose the value of the `origin` request header to make the browser send credentials to their own server. The use of a whitelist containing allowed origins for the Cross-Origin request fixes the issue:\n\n\n```javascript\nvar https = require('https'),\n    url = require('url');\n\nvar server = https.createServer(function(){});\n\nserver.on('request', function(req, res) {\n    let origin = url.parse(req.url, true).query.origin,\n        whitelist = {\n            \"https://example.com\": true,\n            \"https://subdomain.example.com\": true,\n            \"https://example.com:1337\": true\n        };\n\n    if (origin in whitelist) {\n        // GOOD: the origin is in the whitelist\n        res.setHeader(\"Access-Control-Allow-Origin\", origin);\n        res.setHeader(\"Access-Control-Allow-Credentials\", true);\n    }\n\n    // ...\n});\n\n```\n\n## References\n* Mozilla Developer Network: [CORS, Access-Control-Allow-Origin](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin).\n* Mozilla Developer Network: [CORS, Access-Control-Allow-Credentials](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials).\n* PortSwigger: [Exploiting CORS Misconfigurations for Bitcoins and Bounties](http://blog.portswigger.net/2016/10/exploiting-cors-misconfigurations-for.html)\n* W3C: [CORS for developers, Advice for Resource Owners](https://w3c.github.io/webappsec-cors-for-developers/#resources)\n* Common Weakness Enumeration: [CWE-346](https://cwe.mitre.org/data/definitions/346.html).\n* Common Weakness Enumeration: [CWE-639](https://cwe.mitre.org/data/definitions/639.html).\n* Common Weakness Enumeration: [CWE-942](https://cwe.mitre.org/data/definitions/942.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "Credential leak vulnerability due to a misconfigured CORS header value."
      },
      "location": {
        "path": "backend/server.js",
        "start_line": 475,
        "end_line": 475,
        "start_column": 50,
        "end_column": 68
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/391/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 390,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/390",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/390",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/cors-misconfiguration-for-credentials",
      "severity": "error",
      "description": "CORS misconfiguration for credentials transfer",
      "name": "js/cors-misconfiguration-for-credentials",
      "tags": ["external/cwe/cwe-346", "external/cwe/cwe-639", "external/cwe/cwe-942", "security"],
      "full_description": "Misconfiguration of CORS HTTP headers allows for leaks of secret credentials.",
      "help": "# CORS misconfiguration for credentials transfer\nA server can send the `\"Access-Control-Allow-Credentials\"` CORS header to control when a browser may send user credentials in Cross-Origin HTTP requests.\n\nWhen the `Access-Control-Allow-Credentials` header is `\"true\"`, the `Access-Control-Allow-Origin` header must have a value different from `\"*\"` in order to make browsers accept the header. Therefore, to allow multiple origins for Cross-Origin requests with credentials, the server must dynamically compute the value of the `\"Access-Control-Allow-Origin\"` header. Computing this header value from information in the request to the server can therefore potentially allow an attacker to control the origins that the browser sends credentials to.\n\n\n## Recommendation\nWhen the `Access-Control-Allow-Credentials` header value is `\"true\"`, a dynamic computation of the `Access-Control-Allow-Origin` header must involve sanitization if it relies on user-controlled input.\n\nSince the `\"null\"` origin is easy to obtain for an attacker, it is never safe to use `\"null\"` as the value of the `Access-Control-Allow-Origin` header when the `Access-Control-Allow-Credentials` header value is `\"true\"`.\n\n\n## Example\nIn the example below, the server allows the browser to send user credentials in a Cross-Origin request. The request header `origins` controls the allowed origins for such a Cross-Origin request.\n\n\n```javascript\nvar https = require('https'),\n    url = require('url');\n\nvar server = https.createServer(function(){});\n\nserver.on('request', function(req, res) {\n    let origin = url.parse(req.url, true).query.origin;\n     // BAD: attacker can choose the value of origin\n    res.setHeader(\"Access-Control-Allow-Origin\", origin);\n    res.setHeader(\"Access-Control-Allow-Credentials\", true);\n\n    // ...\n});\n\n```\nThis is not secure, since an attacker can choose the value of the `origin` request header to make the browser send credentials to their own server. The use of a whitelist containing allowed origins for the Cross-Origin request fixes the issue:\n\n\n```javascript\nvar https = require('https'),\n    url = require('url');\n\nvar server = https.createServer(function(){});\n\nserver.on('request', function(req, res) {\n    let origin = url.parse(req.url, true).query.origin,\n        whitelist = {\n            \"https://example.com\": true,\n            \"https://subdomain.example.com\": true,\n            \"https://example.com:1337\": true\n        };\n\n    if (origin in whitelist) {\n        // GOOD: the origin is in the whitelist\n        res.setHeader(\"Access-Control-Allow-Origin\", origin);\n        res.setHeader(\"Access-Control-Allow-Credentials\", true);\n    }\n\n    // ...\n});\n\n```\n\n## References\n* Mozilla Developer Network: [CORS, Access-Control-Allow-Origin](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin).\n* Mozilla Developer Network: [CORS, Access-Control-Allow-Credentials](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials).\n* PortSwigger: [Exploiting CORS Misconfigurations for Bitcoins and Bounties](http://blog.portswigger.net/2016/10/exploiting-cors-misconfigurations-for.html)\n* W3C: [CORS for developers, Advice for Resource Owners](https://w3c.github.io/webappsec-cors-for-developers/#resources)\n* Common Weakness Enumeration: [CWE-346](https://cwe.mitre.org/data/definitions/346.html).\n* Common Weakness Enumeration: [CWE-639](https://cwe.mitre.org/data/definitions/639.html).\n* Common Weakness Enumeration: [CWE-942](https://cwe.mitre.org/data/definitions/942.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "Credential leak vulnerability due to a misconfigured CORS header value."
      },
      "location": {
        "path": "backend/routes/storage.js",
        "start_line": 199,
        "end_line": 199,
        "start_column": 54,
        "end_column": 72
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/390/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 389,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/389",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/389",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/cors-misconfiguration-for-credentials",
      "severity": "error",
      "description": "CORS misconfiguration for credentials transfer",
      "name": "js/cors-misconfiguration-for-credentials",
      "tags": ["external/cwe/cwe-346", "external/cwe/cwe-639", "external/cwe/cwe-942", "security"],
      "full_description": "Misconfiguration of CORS HTTP headers allows for leaks of secret credentials.",
      "help": "# CORS misconfiguration for credentials transfer\nA server can send the `\"Access-Control-Allow-Credentials\"` CORS header to control when a browser may send user credentials in Cross-Origin HTTP requests.\n\nWhen the `Access-Control-Allow-Credentials` header is `\"true\"`, the `Access-Control-Allow-Origin` header must have a value different from `\"*\"` in order to make browsers accept the header. Therefore, to allow multiple origins for Cross-Origin requests with credentials, the server must dynamically compute the value of the `\"Access-Control-Allow-Origin\"` header. Computing this header value from information in the request to the server can therefore potentially allow an attacker to control the origins that the browser sends credentials to.\n\n\n## Recommendation\nWhen the `Access-Control-Allow-Credentials` header value is `\"true\"`, a dynamic computation of the `Access-Control-Allow-Origin` header must involve sanitization if it relies on user-controlled input.\n\nSince the `\"null\"` origin is easy to obtain for an attacker, it is never safe to use `\"null\"` as the value of the `Access-Control-Allow-Origin` header when the `Access-Control-Allow-Credentials` header value is `\"true\"`.\n\n\n## Example\nIn the example below, the server allows the browser to send user credentials in a Cross-Origin request. The request header `origins` controls the allowed origins for such a Cross-Origin request.\n\n\n```javascript\nvar https = require('https'),\n    url = require('url');\n\nvar server = https.createServer(function(){});\n\nserver.on('request', function(req, res) {\n    let origin = url.parse(req.url, true).query.origin;\n     // BAD: attacker can choose the value of origin\n    res.setHeader(\"Access-Control-Allow-Origin\", origin);\n    res.setHeader(\"Access-Control-Allow-Credentials\", true);\n\n    // ...\n});\n\n```\nThis is not secure, since an attacker can choose the value of the `origin` request header to make the browser send credentials to their own server. The use of a whitelist containing allowed origins for the Cross-Origin request fixes the issue:\n\n\n```javascript\nvar https = require('https'),\n    url = require('url');\n\nvar server = https.createServer(function(){});\n\nserver.on('request', function(req, res) {\n    let origin = url.parse(req.url, true).query.origin,\n        whitelist = {\n            \"https://example.com\": true,\n            \"https://subdomain.example.com\": true,\n            \"https://example.com:1337\": true\n        };\n\n    if (origin in whitelist) {\n        // GOOD: the origin is in the whitelist\n        res.setHeader(\"Access-Control-Allow-Origin\", origin);\n        res.setHeader(\"Access-Control-Allow-Credentials\", true);\n    }\n\n    // ...\n});\n\n```\n\n## References\n* Mozilla Developer Network: [CORS, Access-Control-Allow-Origin](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin).\n* Mozilla Developer Network: [CORS, Access-Control-Allow-Credentials](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials).\n* PortSwigger: [Exploiting CORS Misconfigurations for Bitcoins and Bounties](http://blog.portswigger.net/2016/10/exploiting-cors-misconfigurations-for.html)\n* W3C: [CORS for developers, Advice for Resource Owners](https://w3c.github.io/webappsec-cors-for-developers/#resources)\n* Common Weakness Enumeration: [CWE-346](https://cwe.mitre.org/data/definitions/346.html).\n* Common Weakness Enumeration: [CWE-639](https://cwe.mitre.org/data/definitions/639.html).\n* Common Weakness Enumeration: [CWE-942](https://cwe.mitre.org/data/definitions/942.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "Credential leak vulnerability due to a misconfigured CORS header value."
      },
      "location": {
        "path": "backend/routes/ai.js",
        "start_line": 4567,
        "end_line": 4567,
        "start_column": 52,
        "end_column": 58
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/389/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 388,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/388",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/388",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/cors-misconfiguration-for-credentials",
      "severity": "error",
      "description": "CORS misconfiguration for credentials transfer",
      "name": "js/cors-misconfiguration-for-credentials",
      "tags": ["external/cwe/cwe-346", "external/cwe/cwe-639", "external/cwe/cwe-942", "security"],
      "full_description": "Misconfiguration of CORS HTTP headers allows for leaks of secret credentials.",
      "help": "# CORS misconfiguration for credentials transfer\nA server can send the `\"Access-Control-Allow-Credentials\"` CORS header to control when a browser may send user credentials in Cross-Origin HTTP requests.\n\nWhen the `Access-Control-Allow-Credentials` header is `\"true\"`, the `Access-Control-Allow-Origin` header must have a value different from `\"*\"` in order to make browsers accept the header. Therefore, to allow multiple origins for Cross-Origin requests with credentials, the server must dynamically compute the value of the `\"Access-Control-Allow-Origin\"` header. Computing this header value from information in the request to the server can therefore potentially allow an attacker to control the origins that the browser sends credentials to.\n\n\n## Recommendation\nWhen the `Access-Control-Allow-Credentials` header value is `\"true\"`, a dynamic computation of the `Access-Control-Allow-Origin` header must involve sanitization if it relies on user-controlled input.\n\nSince the `\"null\"` origin is easy to obtain for an attacker, it is never safe to use `\"null\"` as the value of the `Access-Control-Allow-Origin` header when the `Access-Control-Allow-Credentials` header value is `\"true\"`.\n\n\n## Example\nIn the example below, the server allows the browser to send user credentials in a Cross-Origin request. The request header `origins` controls the allowed origins for such a Cross-Origin request.\n\n\n```javascript\nvar https = require('https'),\n    url = require('url');\n\nvar server = https.createServer(function(){});\n\nserver.on('request', function(req, res) {\n    let origin = url.parse(req.url, true).query.origin;\n     // BAD: attacker can choose the value of origin\n    res.setHeader(\"Access-Control-Allow-Origin\", origin);\n    res.setHeader(\"Access-Control-Allow-Credentials\", true);\n\n    // ...\n});\n\n```\nThis is not secure, since an attacker can choose the value of the `origin` request header to make the browser send credentials to their own server. The use of a whitelist containing allowed origins for the Cross-Origin request fixes the issue:\n\n\n```javascript\nvar https = require('https'),\n    url = require('url');\n\nvar server = https.createServer(function(){});\n\nserver.on('request', function(req, res) {\n    let origin = url.parse(req.url, true).query.origin,\n        whitelist = {\n            \"https://example.com\": true,\n            \"https://subdomain.example.com\": true,\n            \"https://example.com:1337\": true\n        };\n\n    if (origin in whitelist) {\n        // GOOD: the origin is in the whitelist\n        res.setHeader(\"Access-Control-Allow-Origin\", origin);\n        res.setHeader(\"Access-Control-Allow-Credentials\", true);\n    }\n\n    // ...\n});\n\n```\n\n## References\n* Mozilla Developer Network: [CORS, Access-Control-Allow-Origin](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin).\n* Mozilla Developer Network: [CORS, Access-Control-Allow-Credentials](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials).\n* PortSwigger: [Exploiting CORS Misconfigurations for Bitcoins and Bounties](http://blog.portswigger.net/2016/10/exploiting-cors-misconfigurations-for.html)\n* W3C: [CORS for developers, Advice for Resource Owners](https://w3c.github.io/webappsec-cors-for-developers/#resources)\n* Common Weakness Enumeration: [CWE-346](https://cwe.mitre.org/data/definitions/346.html).\n* Common Weakness Enumeration: [CWE-639](https://cwe.mitre.org/data/definitions/639.html).\n* Common Weakness Enumeration: [CWE-942](https://cwe.mitre.org/data/definitions/942.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "Credential leak vulnerability due to a misconfigured CORS header value."
      },
      "location": {
        "path": "backend/routes/activities.v2.js",
        "start_line": 974,
        "end_line": 974,
        "start_column": 54,
        "end_column": 72
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/388/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 387,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/387",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/387",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/cors-misconfiguration-for-credentials",
      "severity": "error",
      "description": "CORS misconfiguration for credentials transfer",
      "name": "js/cors-misconfiguration-for-credentials",
      "tags": ["external/cwe/cwe-346", "external/cwe/cwe-639", "external/cwe/cwe-942", "security"],
      "full_description": "Misconfiguration of CORS HTTP headers allows for leaks of secret credentials.",
      "help": "# CORS misconfiguration for credentials transfer\nA server can send the `\"Access-Control-Allow-Credentials\"` CORS header to control when a browser may send user credentials in Cross-Origin HTTP requests.\n\nWhen the `Access-Control-Allow-Credentials` header is `\"true\"`, the `Access-Control-Allow-Origin` header must have a value different from `\"*\"` in order to make browsers accept the header. Therefore, to allow multiple origins for Cross-Origin requests with credentials, the server must dynamically compute the value of the `\"Access-Control-Allow-Origin\"` header. Computing this header value from information in the request to the server can therefore potentially allow an attacker to control the origins that the browser sends credentials to.\n\n\n## Recommendation\nWhen the `Access-Control-Allow-Credentials` header value is `\"true\"`, a dynamic computation of the `Access-Control-Allow-Origin` header must involve sanitization if it relies on user-controlled input.\n\nSince the `\"null\"` origin is easy to obtain for an attacker, it is never safe to use `\"null\"` as the value of the `Access-Control-Allow-Origin` header when the `Access-Control-Allow-Credentials` header value is `\"true\"`.\n\n\n## Example\nIn the example below, the server allows the browser to send user credentials in a Cross-Origin request. The request header `origins` controls the allowed origins for such a Cross-Origin request.\n\n\n```javascript\nvar https = require('https'),\n    url = require('url');\n\nvar server = https.createServer(function(){});\n\nserver.on('request', function(req, res) {\n    let origin = url.parse(req.url, true).query.origin;\n     // BAD: attacker can choose the value of origin\n    res.setHeader(\"Access-Control-Allow-Origin\", origin);\n    res.setHeader(\"Access-Control-Allow-Credentials\", true);\n\n    // ...\n});\n\n```\nThis is not secure, since an attacker can choose the value of the `origin` request header to make the browser send credentials to their own server. The use of a whitelist containing allowed origins for the Cross-Origin request fixes the issue:\n\n\n```javascript\nvar https = require('https'),\n    url = require('url');\n\nvar server = https.createServer(function(){});\n\nserver.on('request', function(req, res) {\n    let origin = url.parse(req.url, true).query.origin,\n        whitelist = {\n            \"https://example.com\": true,\n            \"https://subdomain.example.com\": true,\n            \"https://example.com:1337\": true\n        };\n\n    if (origin in whitelist) {\n        // GOOD: the origin is in the whitelist\n        res.setHeader(\"Access-Control-Allow-Origin\", origin);\n        res.setHeader(\"Access-Control-Allow-Credentials\", true);\n    }\n\n    // ...\n});\n\n```\n\n## References\n* Mozilla Developer Network: [CORS, Access-Control-Allow-Origin](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin).\n* Mozilla Developer Network: [CORS, Access-Control-Allow-Credentials](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials).\n* PortSwigger: [Exploiting CORS Misconfigurations for Bitcoins and Bounties](http://blog.portswigger.net/2016/10/exploiting-cors-misconfigurations-for.html)\n* W3C: [CORS for developers, Advice for Resource Owners](https://w3c.github.io/webappsec-cors-for-developers/#resources)\n* Common Weakness Enumeration: [CWE-346](https://cwe.mitre.org/data/definitions/346.html).\n* Common Weakness Enumeration: [CWE-639](https://cwe.mitre.org/data/definitions/639.html).\n* Common Weakness Enumeration: [CWE-942](https://cwe.mitre.org/data/definitions/942.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "Credential leak vulnerability due to a misconfigured CORS header value."
      },
      "location": {
        "path": "backend/routes/activities.v2.js",
        "start_line": 906,
        "end_line": 906,
        "start_column": 54,
        "end_column": 72
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/387/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 386,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/386",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/386",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/cors-misconfiguration-for-credentials",
      "severity": "error",
      "description": "CORS misconfiguration for credentials transfer",
      "name": "js/cors-misconfiguration-for-credentials",
      "tags": ["external/cwe/cwe-346", "external/cwe/cwe-639", "external/cwe/cwe-942", "security"],
      "full_description": "Misconfiguration of CORS HTTP headers allows for leaks of secret credentials.",
      "help": "# CORS misconfiguration for credentials transfer\nA server can send the `\"Access-Control-Allow-Credentials\"` CORS header to control when a browser may send user credentials in Cross-Origin HTTP requests.\n\nWhen the `Access-Control-Allow-Credentials` header is `\"true\"`, the `Access-Control-Allow-Origin` header must have a value different from `\"*\"` in order to make browsers accept the header. Therefore, to allow multiple origins for Cross-Origin requests with credentials, the server must dynamically compute the value of the `\"Access-Control-Allow-Origin\"` header. Computing this header value from information in the request to the server can therefore potentially allow an attacker to control the origins that the browser sends credentials to.\n\n\n## Recommendation\nWhen the `Access-Control-Allow-Credentials` header value is `\"true\"`, a dynamic computation of the `Access-Control-Allow-Origin` header must involve sanitization if it relies on user-controlled input.\n\nSince the `\"null\"` origin is easy to obtain for an attacker, it is never safe to use `\"null\"` as the value of the `Access-Control-Allow-Origin` header when the `Access-Control-Allow-Credentials` header value is `\"true\"`.\n\n\n## Example\nIn the example below, the server allows the browser to send user credentials in a Cross-Origin request. The request header `origins` controls the allowed origins for such a Cross-Origin request.\n\n\n```javascript\nvar https = require('https'),\n    url = require('url');\n\nvar server = https.createServer(function(){});\n\nserver.on('request', function(req, res) {\n    let origin = url.parse(req.url, true).query.origin;\n     // BAD: attacker can choose the value of origin\n    res.setHeader(\"Access-Control-Allow-Origin\", origin);\n    res.setHeader(\"Access-Control-Allow-Credentials\", true);\n\n    // ...\n});\n\n```\nThis is not secure, since an attacker can choose the value of the `origin` request header to make the browser send credentials to their own server. The use of a whitelist containing allowed origins for the Cross-Origin request fixes the issue:\n\n\n```javascript\nvar https = require('https'),\n    url = require('url');\n\nvar server = https.createServer(function(){});\n\nserver.on('request', function(req, res) {\n    let origin = url.parse(req.url, true).query.origin,\n        whitelist = {\n            \"https://example.com\": true,\n            \"https://subdomain.example.com\": true,\n            \"https://example.com:1337\": true\n        };\n\n    if (origin in whitelist) {\n        // GOOD: the origin is in the whitelist\n        res.setHeader(\"Access-Control-Allow-Origin\", origin);\n        res.setHeader(\"Access-Control-Allow-Credentials\", true);\n    }\n\n    // ...\n});\n\n```\n\n## References\n* Mozilla Developer Network: [CORS, Access-Control-Allow-Origin](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin).\n* Mozilla Developer Network: [CORS, Access-Control-Allow-Credentials](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials).\n* PortSwigger: [Exploiting CORS Misconfigurations for Bitcoins and Bounties](http://blog.portswigger.net/2016/10/exploiting-cors-misconfigurations-for.html)\n* W3C: [CORS for developers, Advice for Resource Owners](https://w3c.github.io/webappsec-cors-for-developers/#resources)\n* Common Weakness Enumeration: [CWE-346](https://cwe.mitre.org/data/definitions/346.html).\n* Common Weakness Enumeration: [CWE-639](https://cwe.mitre.org/data/definitions/639.html).\n* Common Weakness Enumeration: [CWE-942](https://cwe.mitre.org/data/definitions/942.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "Credential leak vulnerability due to a misconfigured CORS header value."
      },
      "location": {
        "path": "backend/routes/activities.v2.js",
        "start_line": 800,
        "end_line": 800,
        "start_column": 54,
        "end_column": 72
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/386/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 385,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/385",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/385",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/cors-misconfiguration-for-credentials",
      "severity": "error",
      "description": "CORS misconfiguration for credentials transfer",
      "name": "js/cors-misconfiguration-for-credentials",
      "tags": ["external/cwe/cwe-346", "external/cwe/cwe-639", "external/cwe/cwe-942", "security"],
      "full_description": "Misconfiguration of CORS HTTP headers allows for leaks of secret credentials.",
      "help": "# CORS misconfiguration for credentials transfer\nA server can send the `\"Access-Control-Allow-Credentials\"` CORS header to control when a browser may send user credentials in Cross-Origin HTTP requests.\n\nWhen the `Access-Control-Allow-Credentials` header is `\"true\"`, the `Access-Control-Allow-Origin` header must have a value different from `\"*\"` in order to make browsers accept the header. Therefore, to allow multiple origins for Cross-Origin requests with credentials, the server must dynamically compute the value of the `\"Access-Control-Allow-Origin\"` header. Computing this header value from information in the request to the server can therefore potentially allow an attacker to control the origins that the browser sends credentials to.\n\n\n## Recommendation\nWhen the `Access-Control-Allow-Credentials` header value is `\"true\"`, a dynamic computation of the `Access-Control-Allow-Origin` header must involve sanitization if it relies on user-controlled input.\n\nSince the `\"null\"` origin is easy to obtain for an attacker, it is never safe to use `\"null\"` as the value of the `Access-Control-Allow-Origin` header when the `Access-Control-Allow-Credentials` header value is `\"true\"`.\n\n\n## Example\nIn the example below, the server allows the browser to send user credentials in a Cross-Origin request. The request header `origins` controls the allowed origins for such a Cross-Origin request.\n\n\n```javascript\nvar https = require('https'),\n    url = require('url');\n\nvar server = https.createServer(function(){});\n\nserver.on('request', function(req, res) {\n    let origin = url.parse(req.url, true).query.origin;\n     // BAD: attacker can choose the value of origin\n    res.setHeader(\"Access-Control-Allow-Origin\", origin);\n    res.setHeader(\"Access-Control-Allow-Credentials\", true);\n\n    // ...\n});\n\n```\nThis is not secure, since an attacker can choose the value of the `origin` request header to make the browser send credentials to their own server. The use of a whitelist containing allowed origins for the Cross-Origin request fixes the issue:\n\n\n```javascript\nvar https = require('https'),\n    url = require('url');\n\nvar server = https.createServer(function(){});\n\nserver.on('request', function(req, res) {\n    let origin = url.parse(req.url, true).query.origin,\n        whitelist = {\n            \"https://example.com\": true,\n            \"https://subdomain.example.com\": true,\n            \"https://example.com:1337\": true\n        };\n\n    if (origin in whitelist) {\n        // GOOD: the origin is in the whitelist\n        res.setHeader(\"Access-Control-Allow-Origin\", origin);\n        res.setHeader(\"Access-Control-Allow-Credentials\", true);\n    }\n\n    // ...\n});\n\n```\n\n## References\n* Mozilla Developer Network: [CORS, Access-Control-Allow-Origin](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin).\n* Mozilla Developer Network: [CORS, Access-Control-Allow-Credentials](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials).\n* PortSwigger: [Exploiting CORS Misconfigurations for Bitcoins and Bounties](http://blog.portswigger.net/2016/10/exploiting-cors-misconfigurations-for.html)\n* W3C: [CORS for developers, Advice for Resource Owners](https://w3c.github.io/webappsec-cors-for-developers/#resources)\n* Common Weakness Enumeration: [CWE-346](https://cwe.mitre.org/data/definitions/346.html).\n* Common Weakness Enumeration: [CWE-639](https://cwe.mitre.org/data/definitions/639.html).\n* Common Weakness Enumeration: [CWE-942](https://cwe.mitre.org/data/definitions/942.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "Credential leak vulnerability due to a misconfigured CORS header value."
      },
      "location": {
        "path": "backend/routes/activities.v2.js",
        "start_line": 763,
        "end_line": 763,
        "start_column": 54,
        "end_column": 72
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/385/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 384,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/384",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/384",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/cors-misconfiguration-for-credentials",
      "severity": "error",
      "description": "CORS misconfiguration for credentials transfer",
      "name": "js/cors-misconfiguration-for-credentials",
      "tags": ["external/cwe/cwe-346", "external/cwe/cwe-639", "external/cwe/cwe-942", "security"],
      "full_description": "Misconfiguration of CORS HTTP headers allows for leaks of secret credentials.",
      "help": "# CORS misconfiguration for credentials transfer\nA server can send the `\"Access-Control-Allow-Credentials\"` CORS header to control when a browser may send user credentials in Cross-Origin HTTP requests.\n\nWhen the `Access-Control-Allow-Credentials` header is `\"true\"`, the `Access-Control-Allow-Origin` header must have a value different from `\"*\"` in order to make browsers accept the header. Therefore, to allow multiple origins for Cross-Origin requests with credentials, the server must dynamically compute the value of the `\"Access-Control-Allow-Origin\"` header. Computing this header value from information in the request to the server can therefore potentially allow an attacker to control the origins that the browser sends credentials to.\n\n\n## Recommendation\nWhen the `Access-Control-Allow-Credentials` header value is `\"true\"`, a dynamic computation of the `Access-Control-Allow-Origin` header must involve sanitization if it relies on user-controlled input.\n\nSince the `\"null\"` origin is easy to obtain for an attacker, it is never safe to use `\"null\"` as the value of the `Access-Control-Allow-Origin` header when the `Access-Control-Allow-Credentials` header value is `\"true\"`.\n\n\n## Example\nIn the example below, the server allows the browser to send user credentials in a Cross-Origin request. The request header `origins` controls the allowed origins for such a Cross-Origin request.\n\n\n```javascript\nvar https = require('https'),\n    url = require('url');\n\nvar server = https.createServer(function(){});\n\nserver.on('request', function(req, res) {\n    let origin = url.parse(req.url, true).query.origin;\n     // BAD: attacker can choose the value of origin\n    res.setHeader(\"Access-Control-Allow-Origin\", origin);\n    res.setHeader(\"Access-Control-Allow-Credentials\", true);\n\n    // ...\n});\n\n```\nThis is not secure, since an attacker can choose the value of the `origin` request header to make the browser send credentials to their own server. The use of a whitelist containing allowed origins for the Cross-Origin request fixes the issue:\n\n\n```javascript\nvar https = require('https'),\n    url = require('url');\n\nvar server = https.createServer(function(){});\n\nserver.on('request', function(req, res) {\n    let origin = url.parse(req.url, true).query.origin,\n        whitelist = {\n            \"https://example.com\": true,\n            \"https://subdomain.example.com\": true,\n            \"https://example.com:1337\": true\n        };\n\n    if (origin in whitelist) {\n        // GOOD: the origin is in the whitelist\n        res.setHeader(\"Access-Control-Allow-Origin\", origin);\n        res.setHeader(\"Access-Control-Allow-Credentials\", true);\n    }\n\n    // ...\n});\n\n```\n\n## References\n* Mozilla Developer Network: [CORS, Access-Control-Allow-Origin](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin).\n* Mozilla Developer Network: [CORS, Access-Control-Allow-Credentials](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials).\n* PortSwigger: [Exploiting CORS Misconfigurations for Bitcoins and Bounties](http://blog.portswigger.net/2016/10/exploiting-cors-misconfigurations-for.html)\n* W3C: [CORS for developers, Advice for Resource Owners](https://w3c.github.io/webappsec-cors-for-developers/#resources)\n* Common Weakness Enumeration: [CWE-346](https://cwe.mitre.org/data/definitions/346.html).\n* Common Weakness Enumeration: [CWE-639](https://cwe.mitre.org/data/definitions/639.html).\n* Common Weakness Enumeration: [CWE-942](https://cwe.mitre.org/data/definitions/942.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "Credential leak vulnerability due to a misconfigured CORS header value."
      },
      "location": {
        "path": "backend/routes/activities.v2.js",
        "start_line": 664,
        "end_line": 664,
        "start_column": 54,
        "end_column": 72
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/384/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 383,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/383",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/383",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/cors-misconfiguration-for-credentials",
      "severity": "error",
      "description": "CORS misconfiguration for credentials transfer",
      "name": "js/cors-misconfiguration-for-credentials",
      "tags": ["external/cwe/cwe-346", "external/cwe/cwe-639", "external/cwe/cwe-942", "security"],
      "full_description": "Misconfiguration of CORS HTTP headers allows for leaks of secret credentials.",
      "help": "# CORS misconfiguration for credentials transfer\nA server can send the `\"Access-Control-Allow-Credentials\"` CORS header to control when a browser may send user credentials in Cross-Origin HTTP requests.\n\nWhen the `Access-Control-Allow-Credentials` header is `\"true\"`, the `Access-Control-Allow-Origin` header must have a value different from `\"*\"` in order to make browsers accept the header. Therefore, to allow multiple origins for Cross-Origin requests with credentials, the server must dynamically compute the value of the `\"Access-Control-Allow-Origin\"` header. Computing this header value from information in the request to the server can therefore potentially allow an attacker to control the origins that the browser sends credentials to.\n\n\n## Recommendation\nWhen the `Access-Control-Allow-Credentials` header value is `\"true\"`, a dynamic computation of the `Access-Control-Allow-Origin` header must involve sanitization if it relies on user-controlled input.\n\nSince the `\"null\"` origin is easy to obtain for an attacker, it is never safe to use `\"null\"` as the value of the `Access-Control-Allow-Origin` header when the `Access-Control-Allow-Credentials` header value is `\"true\"`.\n\n\n## Example\nIn the example below, the server allows the browser to send user credentials in a Cross-Origin request. The request header `origins` controls the allowed origins for such a Cross-Origin request.\n\n\n```javascript\nvar https = require('https'),\n    url = require('url');\n\nvar server = https.createServer(function(){});\n\nserver.on('request', function(req, res) {\n    let origin = url.parse(req.url, true).query.origin;\n     // BAD: attacker can choose the value of origin\n    res.setHeader(\"Access-Control-Allow-Origin\", origin);\n    res.setHeader(\"Access-Control-Allow-Credentials\", true);\n\n    // ...\n});\n\n```\nThis is not secure, since an attacker can choose the value of the `origin` request header to make the browser send credentials to their own server. The use of a whitelist containing allowed origins for the Cross-Origin request fixes the issue:\n\n\n```javascript\nvar https = require('https'),\n    url = require('url');\n\nvar server = https.createServer(function(){});\n\nserver.on('request', function(req, res) {\n    let origin = url.parse(req.url, true).query.origin,\n        whitelist = {\n            \"https://example.com\": true,\n            \"https://subdomain.example.com\": true,\n            \"https://example.com:1337\": true\n        };\n\n    if (origin in whitelist) {\n        // GOOD: the origin is in the whitelist\n        res.setHeader(\"Access-Control-Allow-Origin\", origin);\n        res.setHeader(\"Access-Control-Allow-Credentials\", true);\n    }\n\n    // ...\n});\n\n```\n\n## References\n* Mozilla Developer Network: [CORS, Access-Control-Allow-Origin](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin).\n* Mozilla Developer Network: [CORS, Access-Control-Allow-Credentials](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials).\n* PortSwigger: [Exploiting CORS Misconfigurations for Bitcoins and Bounties](http://blog.portswigger.net/2016/10/exploiting-cors-misconfigurations-for.html)\n* W3C: [CORS for developers, Advice for Resource Owners](https://w3c.github.io/webappsec-cors-for-developers/#resources)\n* Common Weakness Enumeration: [CWE-346](https://cwe.mitre.org/data/definitions/346.html).\n* Common Weakness Enumeration: [CWE-639](https://cwe.mitre.org/data/definitions/639.html).\n* Common Weakness Enumeration: [CWE-942](https://cwe.mitre.org/data/definitions/942.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "Credential leak vulnerability due to a misconfigured CORS header value."
      },
      "location": {
        "path": "backend/routes/activities.v2.js",
        "start_line": 540,
        "end_line": 540,
        "start_column": 54,
        "end_column": 72
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/383/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 382,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/382",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/382",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/cors-misconfiguration-for-credentials",
      "severity": "error",
      "description": "CORS misconfiguration for credentials transfer",
      "name": "js/cors-misconfiguration-for-credentials",
      "tags": ["external/cwe/cwe-346", "external/cwe/cwe-639", "external/cwe/cwe-942", "security"],
      "full_description": "Misconfiguration of CORS HTTP headers allows for leaks of secret credentials.",
      "help": "# CORS misconfiguration for credentials transfer\nA server can send the `\"Access-Control-Allow-Credentials\"` CORS header to control when a browser may send user credentials in Cross-Origin HTTP requests.\n\nWhen the `Access-Control-Allow-Credentials` header is `\"true\"`, the `Access-Control-Allow-Origin` header must have a value different from `\"*\"` in order to make browsers accept the header. Therefore, to allow multiple origins for Cross-Origin requests with credentials, the server must dynamically compute the value of the `\"Access-Control-Allow-Origin\"` header. Computing this header value from information in the request to the server can therefore potentially allow an attacker to control the origins that the browser sends credentials to.\n\n\n## Recommendation\nWhen the `Access-Control-Allow-Credentials` header value is `\"true\"`, a dynamic computation of the `Access-Control-Allow-Origin` header must involve sanitization if it relies on user-controlled input.\n\nSince the `\"null\"` origin is easy to obtain for an attacker, it is never safe to use `\"null\"` as the value of the `Access-Control-Allow-Origin` header when the `Access-Control-Allow-Credentials` header value is `\"true\"`.\n\n\n## Example\nIn the example below, the server allows the browser to send user credentials in a Cross-Origin request. The request header `origins` controls the allowed origins for such a Cross-Origin request.\n\n\n```javascript\nvar https = require('https'),\n    url = require('url');\n\nvar server = https.createServer(function(){});\n\nserver.on('request', function(req, res) {\n    let origin = url.parse(req.url, true).query.origin;\n     // BAD: attacker can choose the value of origin\n    res.setHeader(\"Access-Control-Allow-Origin\", origin);\n    res.setHeader(\"Access-Control-Allow-Credentials\", true);\n\n    // ...\n});\n\n```\nThis is not secure, since an attacker can choose the value of the `origin` request header to make the browser send credentials to their own server. The use of a whitelist containing allowed origins for the Cross-Origin request fixes the issue:\n\n\n```javascript\nvar https = require('https'),\n    url = require('url');\n\nvar server = https.createServer(function(){});\n\nserver.on('request', function(req, res) {\n    let origin = url.parse(req.url, true).query.origin,\n        whitelist = {\n            \"https://example.com\": true,\n            \"https://subdomain.example.com\": true,\n            \"https://example.com:1337\": true\n        };\n\n    if (origin in whitelist) {\n        // GOOD: the origin is in the whitelist\n        res.setHeader(\"Access-Control-Allow-Origin\", origin);\n        res.setHeader(\"Access-Control-Allow-Credentials\", true);\n    }\n\n    // ...\n});\n\n```\n\n## References\n* Mozilla Developer Network: [CORS, Access-Control-Allow-Origin](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin).\n* Mozilla Developer Network: [CORS, Access-Control-Allow-Credentials](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials).\n* PortSwigger: [Exploiting CORS Misconfigurations for Bitcoins and Bounties](http://blog.portswigger.net/2016/10/exploiting-cors-misconfigurations-for.html)\n* W3C: [CORS for developers, Advice for Resource Owners](https://w3c.github.io/webappsec-cors-for-developers/#resources)\n* Common Weakness Enumeration: [CWE-346](https://cwe.mitre.org/data/definitions/346.html).\n* Common Weakness Enumeration: [CWE-639](https://cwe.mitre.org/data/definitions/639.html).\n* Common Weakness Enumeration: [CWE-942](https://cwe.mitre.org/data/definitions/942.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "Credential leak vulnerability due to a misconfigured CORS header value."
      },
      "location": {
        "path": "backend/middleware/intrusionDetection.js",
        "start_line": 34,
        "end_line": 34,
        "start_column": 50,
        "end_column": 56
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/382/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 381,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/381",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/381",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/tainted-format-string",
      "severity": "warning",
      "description": "Use of externally-controlled format string",
      "name": "js/tainted-format-string",
      "tags": ["external/cwe/cwe-134", "security"],
      "full_description": "Using external input in format strings can lead to garbled output.",
      "help": "# Use of externally-controlled format string\nFunctions like the Node.js standard library function `util.format` accept a format string that is used to format the remaining arguments by providing inline format specifiers. If the format string contains unsanitized input from an untrusted source, then that string may contain unexpected format specifiers that cause garbled output.\n\n\n## Recommendation\nEither sanitize the input before including it in the format string, or use a `%s` specifier in the format string, and pass the untrusted data as corresponding argument.\n\n\n## Example\nThe following program snippet logs information about an unauthorized access attempt. The log message includes the user name, and the user's IP address is passed as an additional argument to `console.log` to be appended to the message:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get(\"unauthorized\", function handler(req, res) {\n  let user = req.query.user;\n  let ip = req.connection.remoteAddress;\n  console.log(\"Unauthorized access attempt by \" + user, ip);\n});\n\n```\nHowever, if a malicious user provides `%d` as their user name, `console.log` will instead attempt to format the `ip` argument as a number. Since IP addresses are not valid numbers, the result of this conversion is `NaN`. The resulting log message will read \"Unauthorized access attempt by NaN\", missing all the information that it was trying to log in the first place.\n\nInstead, the user name should be included using the `%s` specifier:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get(\"unauthorized\", function handler(req, res) {\n  let user = req.query.user;\n  let ip = req.connection.remoteAddress;\n  console.log(\"Unauthorized access attempt by %s\", user, ip);\n});\n\n```\n\n## References\n* Node.js Documentation: [util.format](https://nodejs.org/api/util.html#util_util_format_format_args).\n* Common Weakness Enumeration: [CWE-134](https://cwe.mitre.org/data/definitions/134.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "Format string depends on a user-provided value.\nFormat string depends on a user-provided value."
      },
      "location": {
        "path": "src/utils/apiHealthMonitor.js",
        "start_line": 213,
        "end_line": 213,
        "start_column": 20,
        "end_column": 79
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/381/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 380,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/380",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/380",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/tainted-format-string",
      "severity": "warning",
      "description": "Use of externally-controlled format string",
      "name": "js/tainted-format-string",
      "tags": ["external/cwe/cwe-134", "security"],
      "full_description": "Using external input in format strings can lead to garbled output.",
      "help": "# Use of externally-controlled format string\nFunctions like the Node.js standard library function `util.format` accept a format string that is used to format the remaining arguments by providing inline format specifiers. If the format string contains unsanitized input from an untrusted source, then that string may contain unexpected format specifiers that cause garbled output.\n\n\n## Recommendation\nEither sanitize the input before including it in the format string, or use a `%s` specifier in the format string, and pass the untrusted data as corresponding argument.\n\n\n## Example\nThe following program snippet logs information about an unauthorized access attempt. The log message includes the user name, and the user's IP address is passed as an additional argument to `console.log` to be appended to the message:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get(\"unauthorized\", function handler(req, res) {\n  let user = req.query.user;\n  let ip = req.connection.remoteAddress;\n  console.log(\"Unauthorized access attempt by \" + user, ip);\n});\n\n```\nHowever, if a malicious user provides `%d` as their user name, `console.log` will instead attempt to format the `ip` argument as a number. Since IP addresses are not valid numbers, the result of this conversion is `NaN`. The resulting log message will read \"Unauthorized access attempt by NaN\", missing all the information that it was trying to log in the first place.\n\nInstead, the user name should be included using the `%s` specifier:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get(\"unauthorized\", function handler(req, res) {\n  let user = req.query.user;\n  let ip = req.connection.remoteAddress;\n  console.log(\"Unauthorized access attempt by %s\", user, ip);\n});\n\n```\n\n## References\n* Node.js Documentation: [util.format](https://nodejs.org/api/util.html#util_util_format_format_args).\n* Common Weakness Enumeration: [CWE-134](https://cwe.mitre.org/data/definitions/134.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "Format string depends on a user-provided value.\nFormat string depends on a user-provided value."
      },
      "location": {
        "path": "src/utils/apiHealthMonitor.js",
        "start_line": 158,
        "end_line": 158,
        "start_column": 23,
        "end_column": 86
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/380/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 379,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/379",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/379",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/tainted-format-string",
      "severity": "warning",
      "description": "Use of externally-controlled format string",
      "name": "js/tainted-format-string",
      "tags": ["external/cwe/cwe-134", "security"],
      "full_description": "Using external input in format strings can lead to garbled output.",
      "help": "# Use of externally-controlled format string\nFunctions like the Node.js standard library function `util.format` accept a format string that is used to format the remaining arguments by providing inline format specifiers. If the format string contains unsanitized input from an untrusted source, then that string may contain unexpected format specifiers that cause garbled output.\n\n\n## Recommendation\nEither sanitize the input before including it in the format string, or use a `%s` specifier in the format string, and pass the untrusted data as corresponding argument.\n\n\n## Example\nThe following program snippet logs information about an unauthorized access attempt. The log message includes the user name, and the user's IP address is passed as an additional argument to `console.log` to be appended to the message:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get(\"unauthorized\", function handler(req, res) {\n  let user = req.query.user;\n  let ip = req.connection.remoteAddress;\n  console.log(\"Unauthorized access attempt by \" + user, ip);\n});\n\n```\nHowever, if a malicious user provides `%d` as their user name, `console.log` will instead attempt to format the `ip` argument as a number. Since IP addresses are not valid numbers, the result of this conversion is `NaN`. The resulting log message will read \"Unauthorized access attempt by NaN\", missing all the information that it was trying to log in the first place.\n\nInstead, the user name should be included using the `%s` specifier:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get(\"unauthorized\", function handler(req, res) {\n  let user = req.query.user;\n  let ip = req.connection.remoteAddress;\n  console.log(\"Unauthorized access attempt by %s\", user, ip);\n});\n\n```\n\n## References\n* Node.js Documentation: [util.format](https://nodejs.org/api/util.html#util_util_format_format_args).\n* Common Weakness Enumeration: [CWE-134](https://cwe.mitre.org/data/definitions/134.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "Format string depends on a user-provided value.\nFormat string depends on a user-provided value."
      },
      "location": {
        "path": "backend/lib/braid/chains.js",
        "start_line": 396,
        "end_line": 396,
        "start_column": 19,
        "end_column": 70
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/379/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 378,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/378",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/378",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/tainted-format-string",
      "severity": "warning",
      "description": "Use of externally-controlled format string",
      "name": "js/tainted-format-string",
      "tags": ["external/cwe/cwe-134", "security"],
      "full_description": "Using external input in format strings can lead to garbled output.",
      "help": "# Use of externally-controlled format string\nFunctions like the Node.js standard library function `util.format` accept a format string that is used to format the remaining arguments by providing inline format specifiers. If the format string contains unsanitized input from an untrusted source, then that string may contain unexpected format specifiers that cause garbled output.\n\n\n## Recommendation\nEither sanitize the input before including it in the format string, or use a `%s` specifier in the format string, and pass the untrusted data as corresponding argument.\n\n\n## Example\nThe following program snippet logs information about an unauthorized access attempt. The log message includes the user name, and the user's IP address is passed as an additional argument to `console.log` to be appended to the message:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get(\"unauthorized\", function handler(req, res) {\n  let user = req.query.user;\n  let ip = req.connection.remoteAddress;\n  console.log(\"Unauthorized access attempt by \" + user, ip);\n});\n\n```\nHowever, if a malicious user provides `%d` as their user name, `console.log` will instead attempt to format the `ip` argument as a number. Since IP addresses are not valid numbers, the result of this conversion is `NaN`. The resulting log message will read \"Unauthorized access attempt by NaN\", missing all the information that it was trying to log in the first place.\n\nInstead, the user name should be included using the `%s` specifier:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get(\"unauthorized\", function handler(req, res) {\n  let user = req.query.user;\n  let ip = req.connection.remoteAddress;\n  console.log(\"Unauthorized access attempt by %s\", user, ip);\n});\n\n```\n\n## References\n* Node.js Documentation: [util.format](https://nodejs.org/api/util.html#util_util_format_format_args).\n* Common Weakness Enumeration: [CWE-134](https://cwe.mitre.org/data/definitions/134.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "Format string depends on a user-provided value.\nFormat string depends on a user-provided value."
      },
      "location": {
        "path": "backend/lib/braid/chains.js",
        "start_line": 230,
        "end_line": 230,
        "start_column": 15,
        "end_column": 59
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/378/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 377,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/377",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/377",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/tainted-format-string",
      "severity": "warning",
      "description": "Use of externally-controlled format string",
      "name": "js/tainted-format-string",
      "tags": ["external/cwe/cwe-134", "security"],
      "full_description": "Using external input in format strings can lead to garbled output.",
      "help": "# Use of externally-controlled format string\nFunctions like the Node.js standard library function `util.format` accept a format string that is used to format the remaining arguments by providing inline format specifiers. If the format string contains unsanitized input from an untrusted source, then that string may contain unexpected format specifiers that cause garbled output.\n\n\n## Recommendation\nEither sanitize the input before including it in the format string, or use a `%s` specifier in the format string, and pass the untrusted data as corresponding argument.\n\n\n## Example\nThe following program snippet logs information about an unauthorized access attempt. The log message includes the user name, and the user's IP address is passed as an additional argument to `console.log` to be appended to the message:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get(\"unauthorized\", function handler(req, res) {\n  let user = req.query.user;\n  let ip = req.connection.remoteAddress;\n  console.log(\"Unauthorized access attempt by \" + user, ip);\n});\n\n```\nHowever, if a malicious user provides `%d` as their user name, `console.log` will instead attempt to format the `ip` argument as a number. Since IP addresses are not valid numbers, the result of this conversion is `NaN`. The resulting log message will read \"Unauthorized access attempt by NaN\", missing all the information that it was trying to log in the first place.\n\nInstead, the user name should be included using the `%s` specifier:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get(\"unauthorized\", function handler(req, res) {\n  let user = req.query.user;\n  let ip = req.connection.remoteAddress;\n  console.log(\"Unauthorized access attempt by %s\", user, ip);\n});\n\n```\n\n## References\n* Node.js Documentation: [util.format](https://nodejs.org/api/util.html#util_util_format_format_args).\n* Common Weakness Enumeration: [CWE-134](https://cwe.mitre.org/data/definitions/134.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": { "text": "Format string depends on a user-provided value." },
      "location": {
        "path": "backend/lib/braid/execution.js",
        "start_line": 361,
        "end_line": 361,
        "start_column": 19,
        "end_column": 55
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/377/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 376,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/376",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/376",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/tainted-format-string",
      "severity": "warning",
      "description": "Use of externally-controlled format string",
      "name": "js/tainted-format-string",
      "tags": ["external/cwe/cwe-134", "security"],
      "full_description": "Using external input in format strings can lead to garbled output.",
      "help": "# Use of externally-controlled format string\nFunctions like the Node.js standard library function `util.format` accept a format string that is used to format the remaining arguments by providing inline format specifiers. If the format string contains unsanitized input from an untrusted source, then that string may contain unexpected format specifiers that cause garbled output.\n\n\n## Recommendation\nEither sanitize the input before including it in the format string, or use a `%s` specifier in the format string, and pass the untrusted data as corresponding argument.\n\n\n## Example\nThe following program snippet logs information about an unauthorized access attempt. The log message includes the user name, and the user's IP address is passed as an additional argument to `console.log` to be appended to the message:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get(\"unauthorized\", function handler(req, res) {\n  let user = req.query.user;\n  let ip = req.connection.remoteAddress;\n  console.log(\"Unauthorized access attempt by \" + user, ip);\n});\n\n```\nHowever, if a malicious user provides `%d` as their user name, `console.log` will instead attempt to format the `ip` argument as a number. Since IP addresses are not valid numbers, the result of this conversion is `NaN`. The resulting log message will read \"Unauthorized access attempt by NaN\", missing all the information that it was trying to log in the first place.\n\nInstead, the user name should be included using the `%s` specifier:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get(\"unauthorized\", function handler(req, res) {\n  let user = req.query.user;\n  let ip = req.connection.remoteAddress;\n  console.log(\"Unauthorized access attempt by %s\", user, ip);\n});\n\n```\n\n## References\n* Node.js Documentation: [util.format](https://nodejs.org/api/util.html#util_util_format_format_args).\n* Common Weakness Enumeration: [CWE-134](https://cwe.mitre.org/data/definitions/134.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": { "text": "Format string depends on a user-provided value." },
      "location": {
        "path": "backend/lib/braid/execution.js",
        "start_line": 333,
        "end_line": 333,
        "start_column": 22,
        "end_column": 79
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/376/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 375,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/375",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/375",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/tainted-format-string",
      "severity": "warning",
      "description": "Use of externally-controlled format string",
      "name": "js/tainted-format-string",
      "tags": ["external/cwe/cwe-134", "security"],
      "full_description": "Using external input in format strings can lead to garbled output.",
      "help": "# Use of externally-controlled format string\nFunctions like the Node.js standard library function `util.format` accept a format string that is used to format the remaining arguments by providing inline format specifiers. If the format string contains unsanitized input from an untrusted source, then that string may contain unexpected format specifiers that cause garbled output.\n\n\n## Recommendation\nEither sanitize the input before including it in the format string, or use a `%s` specifier in the format string, and pass the untrusted data as corresponding argument.\n\n\n## Example\nThe following program snippet logs information about an unauthorized access attempt. The log message includes the user name, and the user's IP address is passed as an additional argument to `console.log` to be appended to the message:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get(\"unauthorized\", function handler(req, res) {\n  let user = req.query.user;\n  let ip = req.connection.remoteAddress;\n  console.log(\"Unauthorized access attempt by \" + user, ip);\n});\n\n```\nHowever, if a malicious user provides `%d` as their user name, `console.log` will instead attempt to format the `ip` argument as a number. Since IP addresses are not valid numbers, the result of this conversion is `NaN`. The resulting log message will read \"Unauthorized access attempt by NaN\", missing all the information that it was trying to log in the first place.\n\nInstead, the user name should be included using the `%s` specifier:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get(\"unauthorized\", function handler(req, res) {\n  let user = req.query.user;\n  let ip = req.connection.remoteAddress;\n  console.log(\"Unauthorized access attempt by %s\", user, ip);\n});\n\n```\n\n## References\n* Node.js Documentation: [util.format](https://nodejs.org/api/util.html#util_util_format_format_args).\n* Common Weakness Enumeration: [CWE-134](https://cwe.mitre.org/data/definitions/134.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": { "text": "Format string depends on a user-provided value." },
      "location": {
        "path": "backend/lib/braid/execution.js",
        "start_line": 299,
        "end_line": 299,
        "start_column": 22,
        "end_column": 72
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/375/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 374,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/374",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/374",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/tainted-format-string",
      "severity": "warning",
      "description": "Use of externally-controlled format string",
      "name": "js/tainted-format-string",
      "tags": ["external/cwe/cwe-134", "security"],
      "full_description": "Using external input in format strings can lead to garbled output.",
      "help": "# Use of externally-controlled format string\nFunctions like the Node.js standard library function `util.format` accept a format string that is used to format the remaining arguments by providing inline format specifiers. If the format string contains unsanitized input from an untrusted source, then that string may contain unexpected format specifiers that cause garbled output.\n\n\n## Recommendation\nEither sanitize the input before including it in the format string, or use a `%s` specifier in the format string, and pass the untrusted data as corresponding argument.\n\n\n## Example\nThe following program snippet logs information about an unauthorized access attempt. The log message includes the user name, and the user's IP address is passed as an additional argument to `console.log` to be appended to the message:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get(\"unauthorized\", function handler(req, res) {\n  let user = req.query.user;\n  let ip = req.connection.remoteAddress;\n  console.log(\"Unauthorized access attempt by \" + user, ip);\n});\n\n```\nHowever, if a malicious user provides `%d` as their user name, `console.log` will instead attempt to format the `ip` argument as a number. Since IP addresses are not valid numbers, the result of this conversion is `NaN`. The resulting log message will read \"Unauthorized access attempt by NaN\", missing all the information that it was trying to log in the first place.\n\nInstead, the user name should be included using the `%s` specifier:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get(\"unauthorized\", function handler(req, res) {\n  let user = req.query.user;\n  let ip = req.connection.remoteAddress;\n  console.log(\"Unauthorized access attempt by %s\", user, ip);\n});\n\n```\n\n## References\n* Node.js Documentation: [util.format](https://nodejs.org/api/util.html#util_util_format_format_args).\n* Common Weakness Enumeration: [CWE-134](https://cwe.mitre.org/data/definitions/134.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": { "text": "Format string depends on a user-provided value." },
      "location": {
        "path": "backend/lib/braid/execution.js",
        "start_line": 281,
        "end_line": 281,
        "start_column": 17,
        "end_column": 53
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/374/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 373,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/373",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/373",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/tainted-format-string",
      "severity": "warning",
      "description": "Use of externally-controlled format string",
      "name": "js/tainted-format-string",
      "tags": ["external/cwe/cwe-134", "security"],
      "full_description": "Using external input in format strings can lead to garbled output.",
      "help": "# Use of externally-controlled format string\nFunctions like the Node.js standard library function `util.format` accept a format string that is used to format the remaining arguments by providing inline format specifiers. If the format string contains unsanitized input from an untrusted source, then that string may contain unexpected format specifiers that cause garbled output.\n\n\n## Recommendation\nEither sanitize the input before including it in the format string, or use a `%s` specifier in the format string, and pass the untrusted data as corresponding argument.\n\n\n## Example\nThe following program snippet logs information about an unauthorized access attempt. The log message includes the user name, and the user's IP address is passed as an additional argument to `console.log` to be appended to the message:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get(\"unauthorized\", function handler(req, res) {\n  let user = req.query.user;\n  let ip = req.connection.remoteAddress;\n  console.log(\"Unauthorized access attempt by \" + user, ip);\n});\n\n```\nHowever, if a malicious user provides `%d` as their user name, `console.log` will instead attempt to format the `ip` argument as a number. Since IP addresses are not valid numbers, the result of this conversion is `NaN`. The resulting log message will read \"Unauthorized access attempt by NaN\", missing all the information that it was trying to log in the first place.\n\nInstead, the user name should be included using the `%s` specifier:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get(\"unauthorized\", function handler(req, res) {\n  let user = req.query.user;\n  let ip = req.connection.remoteAddress;\n  console.log(\"Unauthorized access attempt by %s\", user, ip);\n});\n\n```\n\n## References\n* Node.js Documentation: [util.format](https://nodejs.org/api/util.html#util_util_format_format_args).\n* Common Weakness Enumeration: [CWE-134](https://cwe.mitre.org/data/definitions/134.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": { "text": "Format string depends on a user-provided value." },
      "location": {
        "path": "backend/lib/braid/execution.js",
        "start_line": 264,
        "end_line": 264,
        "start_column": 20,
        "end_column": 71
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/373/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 372,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/372",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/372",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/tainted-format-string",
      "severity": "warning",
      "description": "Use of externally-controlled format string",
      "name": "js/tainted-format-string",
      "tags": ["external/cwe/cwe-134", "security"],
      "full_description": "Using external input in format strings can lead to garbled output.",
      "help": "# Use of externally-controlled format string\nFunctions like the Node.js standard library function `util.format` accept a format string that is used to format the remaining arguments by providing inline format specifiers. If the format string contains unsanitized input from an untrusted source, then that string may contain unexpected format specifiers that cause garbled output.\n\n\n## Recommendation\nEither sanitize the input before including it in the format string, or use a `%s` specifier in the format string, and pass the untrusted data as corresponding argument.\n\n\n## Example\nThe following program snippet logs information about an unauthorized access attempt. The log message includes the user name, and the user's IP address is passed as an additional argument to `console.log` to be appended to the message:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get(\"unauthorized\", function handler(req, res) {\n  let user = req.query.user;\n  let ip = req.connection.remoteAddress;\n  console.log(\"Unauthorized access attempt by \" + user, ip);\n});\n\n```\nHowever, if a malicious user provides `%d` as their user name, `console.log` will instead attempt to format the `ip` argument as a number. Since IP addresses are not valid numbers, the result of this conversion is `NaN`. The resulting log message will read \"Unauthorized access attempt by NaN\", missing all the information that it was trying to log in the first place.\n\nInstead, the user name should be included using the `%s` specifier:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get(\"unauthorized\", function handler(req, res) {\n  let user = req.query.user;\n  let ip = req.connection.remoteAddress;\n  console.log(\"Unauthorized access attempt by %s\", user, ip);\n});\n\n```\n\n## References\n* Node.js Documentation: [util.format](https://nodejs.org/api/util.html#util_util_format_format_args).\n* Common Weakness Enumeration: [CWE-134](https://cwe.mitre.org/data/definitions/134.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": { "text": "Format string depends on a user-provided value." },
      "location": {
        "path": "backend/lib/braid/execution.js",
        "start_line": 261,
        "end_line": 261,
        "start_column": 19,
        "end_column": 60
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/372/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 371,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/371",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/371",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/tainted-format-string",
      "severity": "warning",
      "description": "Use of externally-controlled format string",
      "name": "js/tainted-format-string",
      "tags": ["external/cwe/cwe-134", "security"],
      "full_description": "Using external input in format strings can lead to garbled output.",
      "help": "# Use of externally-controlled format string\nFunctions like the Node.js standard library function `util.format` accept a format string that is used to format the remaining arguments by providing inline format specifiers. If the format string contains unsanitized input from an untrusted source, then that string may contain unexpected format specifiers that cause garbled output.\n\n\n## Recommendation\nEither sanitize the input before including it in the format string, or use a `%s` specifier in the format string, and pass the untrusted data as corresponding argument.\n\n\n## Example\nThe following program snippet logs information about an unauthorized access attempt. The log message includes the user name, and the user's IP address is passed as an additional argument to `console.log` to be appended to the message:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get(\"unauthorized\", function handler(req, res) {\n  let user = req.query.user;\n  let ip = req.connection.remoteAddress;\n  console.log(\"Unauthorized access attempt by \" + user, ip);\n});\n\n```\nHowever, if a malicious user provides `%d` as their user name, `console.log` will instead attempt to format the `ip` argument as a number. Since IP addresses are not valid numbers, the result of this conversion is `NaN`. The resulting log message will read \"Unauthorized access attempt by NaN\", missing all the information that it was trying to log in the first place.\n\nInstead, the user name should be included using the `%s` specifier:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get(\"unauthorized\", function handler(req, res) {\n  let user = req.query.user;\n  let ip = req.connection.remoteAddress;\n  console.log(\"Unauthorized access attempt by %s\", user, ip);\n});\n\n```\n\n## References\n* Node.js Documentation: [util.format](https://nodejs.org/api/util.html#util_util_format_format_args).\n* Common Weakness Enumeration: [CWE-134](https://cwe.mitre.org/data/definitions/134.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": { "text": "Format string depends on a user-provided value." },
      "location": {
        "path": "backend/lib/braid/execution.js",
        "start_line": 248,
        "end_line": 248,
        "start_column": 21,
        "end_column": 61
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/371/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 370,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/370",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/370",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/tainted-format-string",
      "severity": "warning",
      "description": "Use of externally-controlled format string",
      "name": "js/tainted-format-string",
      "tags": ["external/cwe/cwe-134", "security"],
      "full_description": "Using external input in format strings can lead to garbled output.",
      "help": "# Use of externally-controlled format string\nFunctions like the Node.js standard library function `util.format` accept a format string that is used to format the remaining arguments by providing inline format specifiers. If the format string contains unsanitized input from an untrusted source, then that string may contain unexpected format specifiers that cause garbled output.\n\n\n## Recommendation\nEither sanitize the input before including it in the format string, or use a `%s` specifier in the format string, and pass the untrusted data as corresponding argument.\n\n\n## Example\nThe following program snippet logs information about an unauthorized access attempt. The log message includes the user name, and the user's IP address is passed as an additional argument to `console.log` to be appended to the message:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get(\"unauthorized\", function handler(req, res) {\n  let user = req.query.user;\n  let ip = req.connection.remoteAddress;\n  console.log(\"Unauthorized access attempt by \" + user, ip);\n});\n\n```\nHowever, if a malicious user provides `%d` as their user name, `console.log` will instead attempt to format the `ip` argument as a number. Since IP addresses are not valid numbers, the result of this conversion is `NaN`. The resulting log message will read \"Unauthorized access attempt by NaN\", missing all the information that it was trying to log in the first place.\n\nInstead, the user name should be included using the `%s` specifier:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get(\"unauthorized\", function handler(req, res) {\n  let user = req.query.user;\n  let ip = req.connection.remoteAddress;\n  console.log(\"Unauthorized access attempt by %s\", user, ip);\n});\n\n```\n\n## References\n* Node.js Documentation: [util.format](https://nodejs.org/api/util.html#util_util_format_format_args).\n* Common Weakness Enumeration: [CWE-134](https://cwe.mitre.org/data/definitions/134.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": { "text": "Format string depends on a user-provided value." },
      "location": {
        "path": "backend/lib/braid/execution.js",
        "start_line": 233,
        "end_line": 233,
        "start_column": 15,
        "end_column": 51
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/370/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 369,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/369",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/369",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/tainted-format-string",
      "severity": "warning",
      "description": "Use of externally-controlled format string",
      "name": "js/tainted-format-string",
      "tags": ["external/cwe/cwe-134", "security"],
      "full_description": "Using external input in format strings can lead to garbled output.",
      "help": "# Use of externally-controlled format string\nFunctions like the Node.js standard library function `util.format` accept a format string that is used to format the remaining arguments by providing inline format specifiers. If the format string contains unsanitized input from an untrusted source, then that string may contain unexpected format specifiers that cause garbled output.\n\n\n## Recommendation\nEither sanitize the input before including it in the format string, or use a `%s` specifier in the format string, and pass the untrusted data as corresponding argument.\n\n\n## Example\nThe following program snippet logs information about an unauthorized access attempt. The log message includes the user name, and the user's IP address is passed as an additional argument to `console.log` to be appended to the message:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get(\"unauthorized\", function handler(req, res) {\n  let user = req.query.user;\n  let ip = req.connection.remoteAddress;\n  console.log(\"Unauthorized access attempt by \" + user, ip);\n});\n\n```\nHowever, if a malicious user provides `%d` as their user name, `console.log` will instead attempt to format the `ip` argument as a number. Since IP addresses are not valid numbers, the result of this conversion is `NaN`. The resulting log message will read \"Unauthorized access attempt by NaN\", missing all the information that it was trying to log in the first place.\n\nInstead, the user name should be included using the `%s` specifier:\n\n\n```javascript\nconst app = require(\"express\")();\n\napp.get(\"unauthorized\", function handler(req, res) {\n  let user = req.query.user;\n  let ip = req.connection.remoteAddress;\n  console.log(\"Unauthorized access attempt by %s\", user, ip);\n});\n\n```\n\n## References\n* Node.js Documentation: [util.format](https://nodejs.org/api/util.html#util_util_format_format_args).\n* Common Weakness Enumeration: [CWE-134](https://cwe.mitre.org/data/definitions/134.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "Format string depends on a user-provided value.\nFormat string depends on a user-provided value."
      },
      "location": {
        "path": "backend/lib/agents/agentRegistry.js",
        "start_line": 527,
        "end_line": 527,
        "start_column": 18,
        "end_column": 70
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/369/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 368,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/368",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/368",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/incomplete-multi-character-sanitization",
      "severity": "warning",
      "description": "Incomplete multi-character sanitization",
      "name": "js/incomplete-multi-character-sanitization",
      "tags": [
        "correctness",
        "external/cwe/cwe-020",
        "external/cwe/cwe-080",
        "external/cwe/cwe-116",
        "security"
      ],
      "full_description": "A sanitizer that removes a sequence of characters may reintroduce the dangerous sequence.",
      "help": "# Incomplete multi-character sanitization\nSanitizing untrusted input is a common technique for preventing injection attacks and other security vulnerabilities. Regular expressions are often used to perform this sanitization. However, when the regular expression matches multiple consecutive characters, replacing it just once can result in the unsafe text reappearing in the sanitized input.\n\nAttackers can exploit this issue by crafting inputs that, when sanitized with an ineffective regular expression, still contain malicious code or content. This can lead to code execution, data exposure, or other vulnerabilities.\n\n\n## Recommendation\nTo prevent this issue, it is highly recommended to use a well-tested sanitization library whenever possible. These libraries are more likely to handle corner cases and ensure effective sanitization.\n\nIf a library is not an option, you can consider alternative strategies to fix the issue. For example, applying the regular expression replacement repeatedly until no more replacements can be performed, or rewriting the regular expression to match single characters instead of the entire unsafe text.\n\n\n## Example\nConsider the following JavaScript code that aims to remove all HTML comment start and end tags:\n\n```javascript\n\nstr.replace(/<!--|--!?>/g, \"\");   \n\n```\nGiven the input string \"&lt;!&lt;!--- comment ---&gt;&gt;\", the output will be \"&lt;!-- comment --&gt;\", which still contains an HTML comment.\n\nOne possible fix for this issue is to apply the regular expression replacement repeatedly until no more replacements can be performed. This ensures that the unsafe text does not re-appear in the sanitized input, effectively removing all instances of the targeted pattern:\n\n```javascript\n\nfunction removeHtmlComments(input) {  \n  let previous;  \n  do {  \n    previous = input;  \n    input = input.replace(/<!--|--!?>/g, \"\");  \n  } while (input !== previous);  \n  return input;  \n}  \n\n```\n\n## Example\nAnother example is the following regular expression intended to remove script tags:\n\n```javascript\n\nstr.replace(/<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/g, \"\");  \n\n```\nIf the input string is \"&lt;scrip&lt;script&gt;is removed&lt;/script&gt;t&gt;alert(123)&lt;/script&gt;\", the output will be \"&lt;script&gt;alert(123)&lt;/script&gt;\", which still contains a script tag.\n\nA fix for this issue is to rewrite the regular expression to match single characters (\"&lt;\" and \"&gt;\") instead of the entire unsafe text. This simplifies the sanitization process and ensures that all potentially unsafe characters are removed:\n\n```javascript\n\nfunction removeAllHtmlTags(input) {  \n  return input.replace(/<|>/g, \"\");  \n}\n\n```\nAnother potential fix is to use the popular `sanitize-html` npm library. It keeps most of the safe HTML tags while removing all unsafe tags and attributes.\n\n```javascript\n\nconst sanitizeHtml = require(\"sanitize-html\");\nfunction removeAllHtmlTags(input) {  \n  return sanitizeHtml(input);  \n}\n\n```\n\n## Example\nLastly, consider a path sanitizer using the regular expression `/\\.\\.\\//`:\n\n```javascript\n\nstr.replace(/\\.\\.\\//g, \"\");  \n\n```\nThe regular expression attempts to strip out all occurrences of `/../` from `str`. This will not work as expected: for the string `/./.././`, for example, it will remove the single occurrence of `/../` in the middle, but the remainder of the string then becomes `/../`, which is another instance of the substring we were trying to remove.\n\nA possible fix for this issue is to use the \"sanitize-filename\" npm library for path sanitization. This library is specifically designed to handle path sanitization, and should handle all corner cases and ensure effective sanitization:\n\n```javascript\n\nconst sanitize = require(\"sanitize-filename\");  \n  \nfunction sanitizePath(input) {  \n  return sanitize(input);  \n}  \n\n```\n\n## References\n* OWASP Top 10: [A1 Injection](https://www.owasp.org/index.php/Top_10-2017_A1-Injection).\n* Stack Overflow: [Removing all script tags from HTML with JS regular expression](https://stackoverflow.com/questions/6659351/removing-all-script-tags-from-html-with-js-regular-expression).\n* Common Weakness Enumeration: [CWE-20](https://cwe.mitre.org/data/definitions/20.html).\n* Common Weakness Enumeration: [CWE-80](https://cwe.mitre.org/data/definitions/80.html).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "This string may still contain <script, which may cause an HTML element injection vulnerability."
      },
      "location": {
        "path": "backend/routes/mcp.js",
        "start_line": 1746,
        "end_line": 1746,
        "start_column": 30,
        "end_column": 69
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/368/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 367,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/367",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/367",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/disabling-certificate-validation",
      "severity": "error",
      "description": "Disabling certificate validation",
      "name": "js/disabling-certificate-validation",
      "tags": ["external/cwe/cwe-295", "external/cwe/cwe-297", "security"],
      "full_description": "Disabling cryptographic certificate validation can cause security vulnerabilities.",
      "help": "# Disabling certificate validation\nCertificate validation is the standard authentication method of a secure TLS connection. Without it, there is no guarantee about who the other party of a TLS connection is, making man-in-the-middle attacks more likely to occur\n\nWhen testing software that uses TLS connections, it may be useful to disable the certificate validation temporarily. But disabling it in production environments is strongly discouraged, unless an alternative method of authentication is used.\n\n\n## Recommendation\nDo not disable certificate validation for TLS connections.\n\n\n## Example\nThe following example shows a HTTPS connection that transfers confidential information to a remote server. But the connection is not secure since the `rejectUnauthorized` option of the connection is set to `false`. As a consequence, anyone can impersonate the remote server, and receive the confidential information.\n\n\n```javascript\nlet https = require(\"https\");\n\nhttps.request(\n  {\n    hostname: \"secure.my-online-bank.com\",\n    port: 443,\n    method: \"POST\",\n    path: \"send-confidential-information\",\n    rejectUnauthorized: false // BAD\n  },\n  response => {\n    // ... communicate with secure.my-online-bank.com\n  }\n);\n\n```\nTo make the connection secure, the `rejectUnauthorized` option should have its default value, or be explicitly set to `true`.\n\n\n## References\n* Wikipedia: [Transport Layer Security (TLS)](https://en.wikipedia.org/wiki/Transport_Layer_Security)\n* Wikipedia: [Man-in-the-middle attack](https://en.wikipedia.org/wiki/Man-in-the-middle_attack)\n* Node.js: [TLS (SSL)](https://nodejs.org/api/tls.html)\n* Common Weakness Enumeration: [CWE-295](https://cwe.mitre.org/data/definitions/295.html).\n* Common Weakness Enumeration: [CWE-297](https://cwe.mitre.org/data/definitions/297.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": { "text": "Disabling certificate validation is strongly discouraged." },
      "location": {
        "path": "backend/scripts/run-sql.js",
        "start_line": 7,
        "end_line": 7,
        "start_column": 1,
        "end_column": 41
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/367/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 340,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/340",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/340",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/clear-text-logging",
      "severity": "error",
      "description": "Clear-text logging of sensitive information",
      "name": "js/clear-text-logging",
      "tags": ["external/cwe/cwe-312", "external/cwe/cwe-359", "external/cwe/cwe-532", "security"],
      "full_description": "Logging sensitive information without encryption or hashing can expose it to an attacker.",
      "help": "# Clear-text logging of sensitive information\nIf sensitive data is written to a log entry it could be exposed to an attacker who gains access to the logs.\n\nPotential attackers can obtain sensitive user data when the log output is displayed. Additionally that data may expose system information such as full path names, system information, and sometimes usernames and passwords.\n\n\n## Recommendation\nSensitive data should not be logged.\n\n\n## Example\nIn the example the entire process environment is logged using \\`console.info\\`. Regular users of the production deployed application should not have access to this much information about the environment configuration.\n\n\n```javascript\n// BAD: Logging cleartext sensitive data\nconsole.info(`[INFO] Environment: ${JSON.stringify(process.env)}`);\n\n```\nIn the second example the data that is logged is not sensitive.\n\n\n```javascript\nlet not_sensitive_data = { a: 1, b : 2} \n// GOOD: it is fine to log data that is not sensitive\nconsole.info(`[INFO] Some object contains: ${JSON.stringify(not_sensitive_data)}`);\n```\n\n## References\n* OWASP: [Insertion of Sensitive Information into Log File](https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/).\n* Common Weakness Enumeration: [CWE-312](https://cwe.mitre.org/data/definitions/312.html).\n* Common Weakness Enumeration: [CWE-359](https://cwe.mitre.org/data/definitions/359.html).\n* Common Weakness Enumeration: [CWE-532](https://cwe.mitre.org/data/definitions/532.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "This logs sensitive data returned by an access to apikey as clear text."
      },
      "location": {
        "path": "backend/test-auth-env.js",
        "start_line": 16,
        "end_line": 16,
        "start_column": 24,
        "end_column": 64
      },
      "classifications": ["test"]
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/340/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 339,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/339",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/339",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/clear-text-logging",
      "severity": "error",
      "description": "Clear-text logging of sensitive information",
      "name": "js/clear-text-logging",
      "tags": ["external/cwe/cwe-312", "external/cwe/cwe-359", "external/cwe/cwe-532", "security"],
      "full_description": "Logging sensitive information without encryption or hashing can expose it to an attacker.",
      "help": "# Clear-text logging of sensitive information\nIf sensitive data is written to a log entry it could be exposed to an attacker who gains access to the logs.\n\nPotential attackers can obtain sensitive user data when the log output is displayed. Additionally that data may expose system information such as full path names, system information, and sometimes usernames and passwords.\n\n\n## Recommendation\nSensitive data should not be logged.\n\n\n## Example\nIn the example the entire process environment is logged using \\`console.info\\`. Regular users of the production deployed application should not have access to this much information about the environment configuration.\n\n\n```javascript\n// BAD: Logging cleartext sensitive data\nconsole.info(`[INFO] Environment: ${JSON.stringify(process.env)}`);\n\n```\nIn the second example the data that is logged is not sensitive.\n\n\n```javascript\nlet not_sensitive_data = { a: 1, b : 2} \n// GOOD: it is fine to log data that is not sensitive\nconsole.info(`[INFO] Some object contains: ${JSON.stringify(not_sensitive_data)}`);\n```\n\n## References\n* OWASP: [Insertion of Sensitive Information into Log File](https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/).\n* Common Weakness Enumeration: [CWE-312](https://cwe.mitre.org/data/definitions/312.html).\n* Common Weakness Enumeration: [CWE-359](https://cwe.mitre.org/data/definitions/359.html).\n* Common Weakness Enumeration: [CWE-532](https://cwe.mitre.org/data/definitions/532.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "This logs sensitive data returned by an access to authKey as clear text."
      },
      "location": {
        "path": "backend/test-auth-env.js",
        "start_line": 15,
        "end_line": 15,
        "start_column": 31,
        "end_column": 78
      },
      "classifications": ["test"]
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/339/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 338,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/338",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/338",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/clear-text-logging",
      "severity": "error",
      "description": "Clear-text logging of sensitive information",
      "name": "js/clear-text-logging",
      "tags": ["external/cwe/cwe-312", "external/cwe/cwe-359", "external/cwe/cwe-532", "security"],
      "full_description": "Logging sensitive information without encryption or hashing can expose it to an attacker.",
      "help": "# Clear-text logging of sensitive information\nIf sensitive data is written to a log entry it could be exposed to an attacker who gains access to the logs.\n\nPotential attackers can obtain sensitive user data when the log output is displayed. Additionally that data may expose system information such as full path names, system information, and sometimes usernames and passwords.\n\n\n## Recommendation\nSensitive data should not be logged.\n\n\n## Example\nIn the example the entire process environment is logged using \\`console.info\\`. Regular users of the production deployed application should not have access to this much information about the environment configuration.\n\n\n```javascript\n// BAD: Logging cleartext sensitive data\nconsole.info(`[INFO] Environment: ${JSON.stringify(process.env)}`);\n\n```\nIn the second example the data that is logged is not sensitive.\n\n\n```javascript\nlet not_sensitive_data = { a: 1, b : 2} \n// GOOD: it is fine to log data that is not sensitive\nconsole.info(`[INFO] Some object contains: ${JSON.stringify(not_sensitive_data)}`);\n```\n\n## References\n* OWASP: [Insertion of Sensitive Information into Log File](https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/).\n* Common Weakness Enumeration: [CWE-312](https://cwe.mitre.org/data/definitions/312.html).\n* Common Weakness Enumeration: [CWE-359](https://cwe.mitre.org/data/definitions/359.html).\n* Common Weakness Enumeration: [CWE-532](https://cwe.mitre.org/data/definitions/532.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "This logs sensitive data returned by an access to authKey as clear text.\nThis logs sensitive data returned by an access to authKey as clear text.\nThis logs sensitive data returned by an access to apikey as clear text."
      },
      "location": {
        "path": "backend/test-auth-debug.mjs",
        "start_line": 7,
        "end_line": 7,
        "start_column": 30,
        "end_column": 62
      },
      "classifications": ["test"]
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/338/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 337,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/337",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/337",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/clear-text-logging",
      "severity": "error",
      "description": "Clear-text logging of sensitive information",
      "name": "js/clear-text-logging",
      "tags": ["external/cwe/cwe-312", "external/cwe/cwe-359", "external/cwe/cwe-532", "security"],
      "full_description": "Logging sensitive information without encryption or hashing can expose it to an attacker.",
      "help": "# Clear-text logging of sensitive information\nIf sensitive data is written to a log entry it could be exposed to an attacker who gains access to the logs.\n\nPotential attackers can obtain sensitive user data when the log output is displayed. Additionally that data may expose system information such as full path names, system information, and sometimes usernames and passwords.\n\n\n## Recommendation\nSensitive data should not be logged.\n\n\n## Example\nIn the example the entire process environment is logged using \\`console.info\\`. Regular users of the production deployed application should not have access to this much information about the environment configuration.\n\n\n```javascript\n// BAD: Logging cleartext sensitive data\nconsole.info(`[INFO] Environment: ${JSON.stringify(process.env)}`);\n\n```\nIn the second example the data that is logged is not sensitive.\n\n\n```javascript\nlet not_sensitive_data = { a: 1, b : 2} \n// GOOD: it is fine to log data that is not sensitive\nconsole.info(`[INFO] Some object contains: ${JSON.stringify(not_sensitive_data)}`);\n```\n\n## References\n* OWASP: [Insertion of Sensitive Information into Log File](https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/).\n* Common Weakness Enumeration: [CWE-312](https://cwe.mitre.org/data/definitions/312.html).\n* Common Weakness Enumeration: [CWE-359](https://cwe.mitre.org/data/definitions/359.html).\n* Common Weakness Enumeration: [CWE-532](https://cwe.mitre.org/data/definitions/532.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "This logs sensitive data returned by an access to effectiveApiKey as clear text.\nThis logs sensitive data returned by an access to ANTHROPIC_API_KEY as clear text.\nThis logs sensitive data returned by an access to OPENAI_API_KEY as clear text."
      },
      "location": {
        "path": "backend/routes/ai.js",
        "start_line": 3075,
        "end_line": 3078,
        "start_column": 13,
        "end_column": 14
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/337/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 336,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/336",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/336",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/clear-text-logging",
      "severity": "error",
      "description": "Clear-text logging of sensitive information",
      "name": "js/clear-text-logging",
      "tags": ["external/cwe/cwe-312", "external/cwe/cwe-359", "external/cwe/cwe-532", "security"],
      "full_description": "Logging sensitive information without encryption or hashing can expose it to an attacker.",
      "help": "# Clear-text logging of sensitive information\nIf sensitive data is written to a log entry it could be exposed to an attacker who gains access to the logs.\n\nPotential attackers can obtain sensitive user data when the log output is displayed. Additionally that data may expose system information such as full path names, system information, and sometimes usernames and passwords.\n\n\n## Recommendation\nSensitive data should not be logged.\n\n\n## Example\nIn the example the entire process environment is logged using \\`console.info\\`. Regular users of the production deployed application should not have access to this much information about the environment configuration.\n\n\n```javascript\n// BAD: Logging cleartext sensitive data\nconsole.info(`[INFO] Environment: ${JSON.stringify(process.env)}`);\n\n```\nIn the second example the data that is logged is not sensitive.\n\n\n```javascript\nlet not_sensitive_data = { a: 1, b : 2} \n// GOOD: it is fine to log data that is not sensitive\nconsole.info(`[INFO] Some object contains: ${JSON.stringify(not_sensitive_data)}`);\n```\n\n## References\n* OWASP: [Insertion of Sensitive Information into Log File](https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/).\n* Common Weakness Enumeration: [CWE-312](https://cwe.mitre.org/data/definitions/312.html).\n* Common Weakness Enumeration: [CWE-359](https://cwe.mitre.org/data/definitions/359.html).\n* Common Weakness Enumeration: [CWE-532](https://cwe.mitre.org/data/definitions/532.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "This logs sensitive data returned by an access to effectiveApiKey as clear text.\nThis logs sensitive data returned by an access to ANTHROPIC_API_KEY as clear text.\nThis logs sensitive data returned by an access to OPENAI_API_KEY as clear text."
      },
      "location": {
        "path": "backend/routes/ai.js",
        "start_line": 3060,
        "end_line": 3063,
        "start_column": 78,
        "end_column": 12
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/336/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 335,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/335",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/335",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/clear-text-logging",
      "severity": "error",
      "description": "Clear-text logging of sensitive information",
      "name": "js/clear-text-logging",
      "tags": ["external/cwe/cwe-312", "external/cwe/cwe-359", "external/cwe/cwe-532", "security"],
      "full_description": "Logging sensitive information without encryption or hashing can expose it to an attacker.",
      "help": "# Clear-text logging of sensitive information\nIf sensitive data is written to a log entry it could be exposed to an attacker who gains access to the logs.\n\nPotential attackers can obtain sensitive user data when the log output is displayed. Additionally that data may expose system information such as full path names, system information, and sometimes usernames and passwords.\n\n\n## Recommendation\nSensitive data should not be logged.\n\n\n## Example\nIn the example the entire process environment is logged using \\`console.info\\`. Regular users of the production deployed application should not have access to this much information about the environment configuration.\n\n\n```javascript\n// BAD: Logging cleartext sensitive data\nconsole.info(`[INFO] Environment: ${JSON.stringify(process.env)}`);\n\n```\nIn the second example the data that is logged is not sensitive.\n\n\n```javascript\nlet not_sensitive_data = { a: 1, b : 2} \n// GOOD: it is fine to log data that is not sensitive\nconsole.info(`[INFO] Some object contains: ${JSON.stringify(not_sensitive_data)}`);\n```\n\n## References\n* OWASP: [Insertion of Sensitive Information into Log File](https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/).\n* Common Weakness Enumeration: [CWE-312](https://cwe.mitre.org/data/definitions/312.html).\n* Common Weakness Enumeration: [CWE-359](https://cwe.mitre.org/data/definitions/359.html).\n* Common Weakness Enumeration: [CWE-532](https://cwe.mitre.org/data/definitions/532.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "This logs sensitive data returned by an access to effectiveApiKey as clear text.\nThis logs sensitive data returned by an access to ANTHROPIC_API_KEY as clear text.\nThis logs sensitive data returned by an access to OPENAI_API_KEY as clear text."
      },
      "location": {
        "path": "backend/routes/ai.js",
        "start_line": 3050,
        "end_line": 3053,
        "start_column": 97,
        "end_column": 12
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/335/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 334,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/334",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/334",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/clear-text-logging",
      "severity": "error",
      "description": "Clear-text logging of sensitive information",
      "name": "js/clear-text-logging",
      "tags": ["external/cwe/cwe-312", "external/cwe/cwe-359", "external/cwe/cwe-532", "security"],
      "full_description": "Logging sensitive information without encryption or hashing can expose it to an attacker.",
      "help": "# Clear-text logging of sensitive information\nIf sensitive data is written to a log entry it could be exposed to an attacker who gains access to the logs.\n\nPotential attackers can obtain sensitive user data when the log output is displayed. Additionally that data may expose system information such as full path names, system information, and sometimes usernames and passwords.\n\n\n## Recommendation\nSensitive data should not be logged.\n\n\n## Example\nIn the example the entire process environment is logged using \\`console.info\\`. Regular users of the production deployed application should not have access to this much information about the environment configuration.\n\n\n```javascript\n// BAD: Logging cleartext sensitive data\nconsole.info(`[INFO] Environment: ${JSON.stringify(process.env)}`);\n\n```\nIn the second example the data that is logged is not sensitive.\n\n\n```javascript\nlet not_sensitive_data = { a: 1, b : 2} \n// GOOD: it is fine to log data that is not sensitive\nconsole.info(`[INFO] Some object contains: ${JSON.stringify(not_sensitive_data)}`);\n```\n\n## References\n* OWASP: [Insertion of Sensitive Information into Log File](https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/).\n* Common Weakness Enumeration: [CWE-312](https://cwe.mitre.org/data/definitions/312.html).\n* Common Weakness Enumeration: [CWE-359](https://cwe.mitre.org/data/definitions/359.html).\n* Common Weakness Enumeration: [CWE-532](https://cwe.mitre.org/data/definitions/532.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "This logs sensitive data returned by an access to apiKey as clear text.\nThis logs sensitive data returned by an access to apiKey as clear text."
      },
      "location": {
        "path": "backend/routes/ai.js",
        "start_line": 3011,
        "end_line": 3021,
        "start_column": 53,
        "end_column": 8
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/334/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 333,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/333",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/333",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/clear-text-logging",
      "severity": "error",
      "description": "Clear-text logging of sensitive information",
      "name": "js/clear-text-logging",
      "tags": ["external/cwe/cwe-312", "external/cwe/cwe-359", "external/cwe/cwe-532", "security"],
      "full_description": "Logging sensitive information without encryption or hashing can expose it to an attacker.",
      "help": "# Clear-text logging of sensitive information\nIf sensitive data is written to a log entry it could be exposed to an attacker who gains access to the logs.\n\nPotential attackers can obtain sensitive user data when the log output is displayed. Additionally that data may expose system information such as full path names, system information, and sometimes usernames and passwords.\n\n\n## Recommendation\nSensitive data should not be logged.\n\n\n## Example\nIn the example the entire process environment is logged using \\`console.info\\`. Regular users of the production deployed application should not have access to this much information about the environment configuration.\n\n\n```javascript\n// BAD: Logging cleartext sensitive data\nconsole.info(`[INFO] Environment: ${JSON.stringify(process.env)}`);\n\n```\nIn the second example the data that is logged is not sensitive.\n\n\n```javascript\nlet not_sensitive_data = { a: 1, b : 2} \n// GOOD: it is fine to log data that is not sensitive\nconsole.info(`[INFO] Some object contains: ${JSON.stringify(not_sensitive_data)}`);\n```\n\n## References\n* OWASP: [Insertion of Sensitive Information into Log File](https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/).\n* Common Weakness Enumeration: [CWE-312](https://cwe.mitre.org/data/definitions/312.html).\n* Common Weakness Enumeration: [CWE-359](https://cwe.mitre.org/data/definitions/359.html).\n* Common Weakness Enumeration: [CWE-532](https://cwe.mitre.org/data/definitions/532.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "This logs sensitive data returned by an access to apiKey as clear text.\nThis logs sensitive data returned by an access to apiKey as clear text."
      },
      "location": {
        "path": "backend/routes/ai.js",
        "start_line": 861,
        "end_line": 871,
        "start_column": 74,
        "end_column": 8
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/333/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 332,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/332",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/332",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/clear-text-logging",
      "severity": "error",
      "description": "Clear-text logging of sensitive information",
      "name": "js/clear-text-logging",
      "tags": ["external/cwe/cwe-312", "external/cwe/cwe-359", "external/cwe/cwe-532", "security"],
      "full_description": "Logging sensitive information without encryption or hashing can expose it to an attacker.",
      "help": "# Clear-text logging of sensitive information\nIf sensitive data is written to a log entry it could be exposed to an attacker who gains access to the logs.\n\nPotential attackers can obtain sensitive user data when the log output is displayed. Additionally that data may expose system information such as full path names, system information, and sometimes usernames and passwords.\n\n\n## Recommendation\nSensitive data should not be logged.\n\n\n## Example\nIn the example the entire process environment is logged using \\`console.info\\`. Regular users of the production deployed application should not have access to this much information about the environment configuration.\n\n\n```javascript\n// BAD: Logging cleartext sensitive data\nconsole.info(`[INFO] Environment: ${JSON.stringify(process.env)}`);\n\n```\nIn the second example the data that is logged is not sensitive.\n\n\n```javascript\nlet not_sensitive_data = { a: 1, b : 2} \n// GOOD: it is fine to log data that is not sensitive\nconsole.info(`[INFO] Some object contains: ${JSON.stringify(not_sensitive_data)}`);\n```\n\n## References\n* OWASP: [Insertion of Sensitive Information into Log File](https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/).\n* Common Weakness Enumeration: [CWE-312](https://cwe.mitre.org/data/definitions/312.html).\n* Common Weakness Enumeration: [CWE-359](https://cwe.mitre.org/data/definitions/359.html).\n* Common Weakness Enumeration: [CWE-532](https://cwe.mitre.org/data/definitions/532.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "This logs sensitive data returned by process environment as clear text.\nThis logs sensitive data returned by process environment as clear text."
      },
      "location": {
        "path": "backend/routes/auth.js",
        "start_line": 723,
        "end_line": 727,
        "start_column": 59,
        "end_column": 10
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/332/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 331,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/331",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/331",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/clear-text-logging",
      "severity": "error",
      "description": "Clear-text logging of sensitive information",
      "name": "js/clear-text-logging",
      "tags": ["external/cwe/cwe-312", "external/cwe/cwe-359", "external/cwe/cwe-532", "security"],
      "full_description": "Logging sensitive information without encryption or hashing can expose it to an attacker.",
      "help": "# Clear-text logging of sensitive information\nIf sensitive data is written to a log entry it could be exposed to an attacker who gains access to the logs.\n\nPotential attackers can obtain sensitive user data when the log output is displayed. Additionally that data may expose system information such as full path names, system information, and sometimes usernames and passwords.\n\n\n## Recommendation\nSensitive data should not be logged.\n\n\n## Example\nIn the example the entire process environment is logged using \\`console.info\\`. Regular users of the production deployed application should not have access to this much information about the environment configuration.\n\n\n```javascript\n// BAD: Logging cleartext sensitive data\nconsole.info(`[INFO] Environment: ${JSON.stringify(process.env)}`);\n\n```\nIn the second example the data that is logged is not sensitive.\n\n\n```javascript\nlet not_sensitive_data = { a: 1, b : 2} \n// GOOD: it is fine to log data that is not sensitive\nconsole.info(`[INFO] Some object contains: ${JSON.stringify(not_sensitive_data)}`);\n```\n\n## References\n* OWASP: [Insertion of Sensitive Information into Log File](https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/).\n* Common Weakness Enumeration: [CWE-312](https://cwe.mitre.org/data/definitions/312.html).\n* Common Weakness Enumeration: [CWE-359](https://cwe.mitre.org/data/definitions/359.html).\n* Common Weakness Enumeration: [CWE-532](https://cwe.mitre.org/data/definitions/532.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "This logs sensitive data returned by an access to providedApiKey as clear text."
      },
      "location": {
        "path": "backend/middleware/authenticate.js",
        "start_line": 57,
        "end_line": 66,
        "start_column": 70,
        "end_column": 8
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/331/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 330,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/330",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/330",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/clear-text-logging",
      "severity": "error",
      "description": "Clear-text logging of sensitive information",
      "name": "js/clear-text-logging",
      "tags": ["external/cwe/cwe-312", "external/cwe/cwe-359", "external/cwe/cwe-532", "security"],
      "full_description": "Logging sensitive information without encryption or hashing can expose it to an attacker.",
      "help": "# Clear-text logging of sensitive information\nIf sensitive data is written to a log entry it could be exposed to an attacker who gains access to the logs.\n\nPotential attackers can obtain sensitive user data when the log output is displayed. Additionally that data may expose system information such as full path names, system information, and sometimes usernames and passwords.\n\n\n## Recommendation\nSensitive data should not be logged.\n\n\n## Example\nIn the example the entire process environment is logged using \\`console.info\\`. Regular users of the production deployed application should not have access to this much information about the environment configuration.\n\n\n```javascript\n// BAD: Logging cleartext sensitive data\nconsole.info(`[INFO] Environment: ${JSON.stringify(process.env)}`);\n\n```\nIn the second example the data that is logged is not sensitive.\n\n\n```javascript\nlet not_sensitive_data = { a: 1, b : 2} \n// GOOD: it is fine to log data that is not sensitive\nconsole.info(`[INFO] Some object contains: ${JSON.stringify(not_sensitive_data)}`);\n```\n\n## References\n* OWASP: [Insertion of Sensitive Information into Log File](https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/).\n* Common Weakness Enumeration: [CWE-312](https://cwe.mitre.org/data/definitions/312.html).\n* Common Weakness Enumeration: [CWE-359](https://cwe.mitre.org/data/definitions/359.html).\n* Common Weakness Enumeration: [CWE-532](https://cwe.mitre.org/data/definitions/532.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "This logs sensitive data returned by process environment as clear text."
      },
      "location": {
        "path": "backend/lib/braid/execution.js",
        "start_line": 190,
        "end_line": 190,
        "start_column": 78,
        "end_column": 98
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/330/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 329,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/329",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/329",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/clear-text-logging",
      "severity": "error",
      "description": "Clear-text logging of sensitive information",
      "name": "js/clear-text-logging",
      "tags": ["external/cwe/cwe-312", "external/cwe/cwe-359", "external/cwe/cwe-532", "security"],
      "full_description": "Logging sensitive information without encryption or hashing can expose it to an attacker.",
      "help": "# Clear-text logging of sensitive information\nIf sensitive data is written to a log entry it could be exposed to an attacker who gains access to the logs.\n\nPotential attackers can obtain sensitive user data when the log output is displayed. Additionally that data may expose system information such as full path names, system information, and sometimes usernames and passwords.\n\n\n## Recommendation\nSensitive data should not be logged.\n\n\n## Example\nIn the example the entire process environment is logged using \\`console.info\\`. Regular users of the production deployed application should not have access to this much information about the environment configuration.\n\n\n```javascript\n// BAD: Logging cleartext sensitive data\nconsole.info(`[INFO] Environment: ${JSON.stringify(process.env)}`);\n\n```\nIn the second example the data that is logged is not sensitive.\n\n\n```javascript\nlet not_sensitive_data = { a: 1, b : 2} \n// GOOD: it is fine to log data that is not sensitive\nconsole.info(`[INFO] Some object contains: ${JSON.stringify(not_sensitive_data)}`);\n```\n\n## References\n* OWASP: [Insertion of Sensitive Information into Log File](https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/).\n* Common Weakness Enumeration: [CWE-312](https://cwe.mitre.org/data/definitions/312.html).\n* Common Weakness Enumeration: [CWE-359](https://cwe.mitre.org/data/definitions/359.html).\n* Common Weakness Enumeration: [CWE-532](https://cwe.mitre.org/data/definitions/532.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "This logs sensitive data returned by process environment as clear text."
      },
      "location": {
        "path": "backend/lib/braid/execution.js",
        "start_line": 159,
        "end_line": 166,
        "start_column": 62,
        "end_column": 10
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/329/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 328,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/328",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/328",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/clear-text-logging",
      "severity": "error",
      "description": "Clear-text logging of sensitive information",
      "name": "js/clear-text-logging",
      "tags": ["external/cwe/cwe-312", "external/cwe/cwe-359", "external/cwe/cwe-532", "security"],
      "full_description": "Logging sensitive information without encryption or hashing can expose it to an attacker.",
      "help": "# Clear-text logging of sensitive information\nIf sensitive data is written to a log entry it could be exposed to an attacker who gains access to the logs.\n\nPotential attackers can obtain sensitive user data when the log output is displayed. Additionally that data may expose system information such as full path names, system information, and sometimes usernames and passwords.\n\n\n## Recommendation\nSensitive data should not be logged.\n\n\n## Example\nIn the example the entire process environment is logged using \\`console.info\\`. Regular users of the production deployed application should not have access to this much information about the environment configuration.\n\n\n```javascript\n// BAD: Logging cleartext sensitive data\nconsole.info(`[INFO] Environment: ${JSON.stringify(process.env)}`);\n\n```\nIn the second example the data that is logged is not sensitive.\n\n\n```javascript\nlet not_sensitive_data = { a: 1, b : 2} \n// GOOD: it is fine to log data that is not sensitive\nconsole.info(`[INFO] Some object contains: ${JSON.stringify(not_sensitive_data)}`);\n```\n\n## References\n* OWASP: [Insertion of Sensitive Information into Log File](https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/).\n* Common Weakness Enumeration: [CWE-312](https://cwe.mitre.org/data/definitions/312.html).\n* Common Weakness Enumeration: [CWE-359](https://cwe.mitre.org/data/definitions/359.html).\n* Common Weakness Enumeration: [CWE-532](https://cwe.mitre.org/data/definitions/532.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "This logs sensitive data returned by process environment as clear text."
      },
      "location": {
        "path": "backend/lib/braid/execution.js",
        "start_line": 132,
        "end_line": 139,
        "start_column": 82,
        "end_column": 8
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/328/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 327,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/327",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/327",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/clear-text-logging",
      "severity": "error",
      "description": "Clear-text logging of sensitive information",
      "name": "js/clear-text-logging",
      "tags": ["external/cwe/cwe-312", "external/cwe/cwe-359", "external/cwe/cwe-532", "security"],
      "full_description": "Logging sensitive information without encryption or hashing can expose it to an attacker.",
      "help": "# Clear-text logging of sensitive information\nIf sensitive data is written to a log entry it could be exposed to an attacker who gains access to the logs.\n\nPotential attackers can obtain sensitive user data when the log output is displayed. Additionally that data may expose system information such as full path names, system information, and sometimes usernames and passwords.\n\n\n## Recommendation\nSensitive data should not be logged.\n\n\n## Example\nIn the example the entire process environment is logged using \\`console.info\\`. Regular users of the production deployed application should not have access to this much information about the environment configuration.\n\n\n```javascript\n// BAD: Logging cleartext sensitive data\nconsole.info(`[INFO] Environment: ${JSON.stringify(process.env)}`);\n\n```\nIn the second example the data that is logged is not sensitive.\n\n\n```javascript\nlet not_sensitive_data = { a: 1, b : 2} \n// GOOD: it is fine to log data that is not sensitive\nconsole.info(`[INFO] Some object contains: ${JSON.stringify(not_sensitive_data)}`);\n```\n\n## References\n* OWASP: [Insertion of Sensitive Information into Log File](https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/).\n* Common Weakness Enumeration: [CWE-312](https://cwe.mitre.org/data/definitions/312.html).\n* Common Weakness Enumeration: [CWE-359](https://cwe.mitre.org/data/definitions/359.html).\n* Common Weakness Enumeration: [CWE-532](https://cwe.mitre.org/data/definitions/532.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "This logs sensitive data returned by process environment as clear text."
      },
      "location": {
        "path": "backend/lib/braid/execution.js",
        "start_line": 69,
        "end_line": 76,
        "start_column": 95,
        "end_column": 6
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/327/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 326,
    "created_at": "2026-02-19T17:36:54Z",
    "updated_at": "2026-02-19T17:36:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/326",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/326",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/clear-text-logging",
      "severity": "error",
      "description": "Clear-text logging of sensitive information",
      "name": "js/clear-text-logging",
      "tags": ["external/cwe/cwe-312", "external/cwe/cwe-359", "external/cwe/cwe-532", "security"],
      "full_description": "Logging sensitive information without encryption or hashing can expose it to an attacker.",
      "help": "# Clear-text logging of sensitive information\nIf sensitive data is written to a log entry it could be exposed to an attacker who gains access to the logs.\n\nPotential attackers can obtain sensitive user data when the log output is displayed. Additionally that data may expose system information such as full path names, system information, and sometimes usernames and passwords.\n\n\n## Recommendation\nSensitive data should not be logged.\n\n\n## Example\nIn the example the entire process environment is logged using \\`console.info\\`. Regular users of the production deployed application should not have access to this much information about the environment configuration.\n\n\n```javascript\n// BAD: Logging cleartext sensitive data\nconsole.info(`[INFO] Environment: ${JSON.stringify(process.env)}`);\n\n```\nIn the second example the data that is logged is not sensitive.\n\n\n```javascript\nlet not_sensitive_data = { a: 1, b : 2} \n// GOOD: it is fine to log data that is not sensitive\nconsole.info(`[INFO] Some object contains: ${JSON.stringify(not_sensitive_data)}`);\n```\n\n## References\n* OWASP: [Insertion of Sensitive Information into Log File](https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/).\n* Common Weakness Enumeration: [CWE-312](https://cwe.mitre.org/data/definitions/312.html).\n* Common Weakness Enumeration: [CWE-359](https://cwe.mitre.org/data/definitions/359.html).\n* Common Weakness Enumeration: [CWE-532](https://cwe.mitre.org/data/definitions/532.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "This logs sensitive data returned by an access to authKey as clear text.\nThis logs sensitive data returned by an access to authKey as clear text.\nThis logs sensitive data returned by an access to apikey as clear text."
      },
      "location": {
        "path": "backend/__tests__/schema/field-parity.test.js",
        "start_line": 262,
        "end_line": 262,
        "start_column": 55,
        "end_column": 91
      },
      "classifications": ["test"]
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/326/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 325,
    "created_at": "2026-01-02T00:05:54Z",
    "updated_at": "2026-01-02T00:05:54Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/325",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/325",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/type-confusion-through-parameter-tampering",
      "severity": "error",
      "description": "Type confusion through parameter tampering",
      "name": "js/type-confusion-through-parameter-tampering",
      "tags": ["external/cwe/cwe-843", "security"],
      "full_description": "Sanitizing an HTTP request parameter may be ineffective if the user controls its type.",
      "help": "# Type confusion through parameter tampering\nSanitizing untrusted HTTP request parameters is a common technique for preventing injection attacks such as SQL injection or path traversal. This is sometimes done by checking if the request parameters contain blacklisted substrings.\n\nHowever, sanitizing request parameters assuming they have type `String` and using the builtin string methods such as `String.prototype.indexOf` is susceptible to type confusion attacks. In a type confusion attack, an attacker tampers with an HTTP request parameter such that it has a value of type `Array` instead of the expected type `String`. Furthermore, the content of the array has been crafted to bypass sanitizers by exploiting that some identically named methods of strings and arrays behave differently.\n\n\n## Recommendation\nCheck the runtime type of sanitizer inputs if the input type is user-controlled.\n\nAn even safer alternative is to design the application so that sanitization is not needed, for instance by using prepared statements for SQL queries.\n\n\n## Example\nFor example, Node.js server frameworks usually present request parameters as strings. But if an attacker sends multiple request parameters with the same name, then the request parameter is represented as an array instead.\n\nIn the following example, a sanitizer checks that a path does not contain the `\"..\"` string, which would allow an attacker to access content outside a user-accessible directory.\n\n\n```javascript\nvar app = require(\"express\")(),\n  path = require(\"path\");\n\napp.get(\"/user-files\", function(req, res) {\n  var file = req.param(\"file\");\n  if (file.indexOf(\"..\") !== -1) {\n    // BAD\n    // we forbid relative paths that contain ..\n    // as these could leave the public directory\n    res.status(400).send(\"Bad request\");\n  } else {\n    var absolute = path.resolve(\"/public/\" + file);\n    console.log(\"Sending file: %s\", absolute);\n    res.sendFile(absolute);\n  }\n});\n\n```\nAs written, this sanitizer is ineffective: an array like `[\"../\", \"/../secret.txt\"]` will bypass the sanitizer. The array does not contain `\"..\"` as an element, so the call to `indexOf` returns `-1` . This is problematic since the value of the `absolute` variable then ends up being `\"/secret.txt\"`. This happens since the concatenation of `\"/public/\"` and the array results in `\"/public/../,/../secret.txt\"`, which the `resolve`-call converts to `\"/secret.txt\"`.\n\nTo fix the sanitizer, check that the request parameter is a string, and not an array:\n\n\n```javascript\nvar app = require(\"express\")(),\n  path = require(\"path\");\n\napp.get(\"/user-files\", function(req, res) {\n  var file = req.param(\"file\");\n  if (typeof file !== 'string' || file.indexOf(\"..\") !== -1) {\n    // GOOD\n    // we forbid relative paths that contain ..\n    // as these could leave the public directory\n    res.status(400).send(\"Bad request\");\n  } else {\n    var absolute = path.resolve(\"/public/\" + file);\n    console.log(\"Sending file: %s\", absolute);\n    res.sendFile(absolute);\n  }\n});\n\n```\n\n## References\n* Node.js API: [querystring](https://nodejs.org/api/querystring.html).\n* Common Weakness Enumeration: [CWE-843](https://cwe.mitre.org/data/definitions/843.html).\n",
      "security_severity_level": "critical"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "Potential type confusion as this HTTP request parameter may be either an array or a string."
      },
      "location": {
        "path": "backend/routes/activities.v2.js",
        "start_line": 202,
        "end_line": 202,
        "start_column": 9,
        "end_column": 19
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/325/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 317,
    "created_at": "2025-12-30T15:44:21Z",
    "updated_at": "2025-12-30T15:44:21Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/317",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/317",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/cors-misconfiguration-for-credentials",
      "severity": "error",
      "description": "CORS misconfiguration for credentials transfer",
      "name": "js/cors-misconfiguration-for-credentials",
      "tags": ["external/cwe/cwe-346", "external/cwe/cwe-639", "external/cwe/cwe-942", "security"],
      "full_description": "Misconfiguration of CORS HTTP headers allows for leaks of secret credentials.",
      "help": "# CORS misconfiguration for credentials transfer\nA server can send the `\"Access-Control-Allow-Credentials\"` CORS header to control when a browser may send user credentials in Cross-Origin HTTP requests.\n\nWhen the `Access-Control-Allow-Credentials` header is `\"true\"`, the `Access-Control-Allow-Origin` header must have a value different from `\"*\"` in order to make browsers accept the header. Therefore, to allow multiple origins for Cross-Origin requests with credentials, the server must dynamically compute the value of the `\"Access-Control-Allow-Origin\"` header. Computing this header value from information in the request to the server can therefore potentially allow an attacker to control the origins that the browser sends credentials to.\n\n\n## Recommendation\nWhen the `Access-Control-Allow-Credentials` header value is `\"true\"`, a dynamic computation of the `Access-Control-Allow-Origin` header must involve sanitization if it relies on user-controlled input.\n\nSince the `\"null\"` origin is easy to obtain for an attacker, it is never safe to use `\"null\"` as the value of the `Access-Control-Allow-Origin` header when the `Access-Control-Allow-Credentials` header value is `\"true\"`.\n\n\n## Example\nIn the example below, the server allows the browser to send user credentials in a Cross-Origin request. The request header `origins` controls the allowed origins for such a Cross-Origin request.\n\n\n```javascript\nvar https = require('https'),\n    url = require('url');\n\nvar server = https.createServer(function(){});\n\nserver.on('request', function(req, res) {\n    let origin = url.parse(req.url, true).query.origin;\n     // BAD: attacker can choose the value of origin\n    res.setHeader(\"Access-Control-Allow-Origin\", origin);\n    res.setHeader(\"Access-Control-Allow-Credentials\", true);\n\n    // ...\n});\n\n```\nThis is not secure, since an attacker can choose the value of the `origin` request header to make the browser send credentials to their own server. The use of a whitelist containing allowed origins for the Cross-Origin request fixes the issue:\n\n\n```javascript\nvar https = require('https'),\n    url = require('url');\n\nvar server = https.createServer(function(){});\n\nserver.on('request', function(req, res) {\n    let origin = url.parse(req.url, true).query.origin,\n        whitelist = {\n            \"https://example.com\": true,\n            \"https://subdomain.example.com\": true,\n            \"https://example.com:1337\": true\n        };\n\n    if (origin in whitelist) {\n        // GOOD: the origin is in the whitelist\n        res.setHeader(\"Access-Control-Allow-Origin\", origin);\n        res.setHeader(\"Access-Control-Allow-Credentials\", true);\n    }\n\n    // ...\n});\n\n```\n\n## References\n* Mozilla Developer Network: [CORS, Access-Control-Allow-Origin](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin).\n* Mozilla Developer Network: [CORS, Access-Control-Allow-Credentials](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials).\n* PortSwigger: [Exploiting CORS Misconfigurations for Bitcoins and Bounties](http://blog.portswigger.net/2016/10/exploiting-cors-misconfigurations-for.html)\n* W3C: [CORS for developers, Advice for Resource Owners](https://w3c.github.io/webappsec-cors-for-developers/#resources)\n* Common Weakness Enumeration: [CWE-346](https://cwe.mitre.org/data/definitions/346.html).\n* Common Weakness Enumeration: [CWE-639](https://cwe.mitre.org/data/definitions/639.html).\n* Common Weakness Enumeration: [CWE-942](https://cwe.mitre.org/data/definitions/942.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "Credential leak vulnerability due to a misconfigured CORS header value."
      },
      "location": {
        "path": "backend/server.js",
        "start_line": 463,
        "end_line": 463,
        "start_column": 50,
        "end_column": 68
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/317/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 145,
    "created_at": "2025-12-29T00:25:24Z",
    "updated_at": "2025-12-29T00:25:24Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/145",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/145",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/clear-text-logging",
      "severity": "error",
      "description": "Clear-text logging of sensitive information",
      "name": "js/clear-text-logging",
      "tags": ["external/cwe/cwe-312", "external/cwe/cwe-359", "external/cwe/cwe-532", "security"],
      "full_description": "Logging sensitive information without encryption or hashing can expose it to an attacker.",
      "help": "# Clear-text logging of sensitive information\nIf sensitive data is written to a log entry it could be exposed to an attacker who gains access to the logs.\n\nPotential attackers can obtain sensitive user data when the log output is displayed. Additionally that data may expose system information such as full path names, system information, and sometimes usernames and passwords.\n\n\n## Recommendation\nSensitive data should not be logged.\n\n\n## Example\nIn the example the entire process environment is logged using \\`console.info\\`. Regular users of the production deployed application should not have access to this much information about the environment configuration.\n\n\n```javascript\n// BAD: Logging cleartext sensitive data\nconsole.info(`[INFO] Environment: ${JSON.stringify(process.env)}`);\n\n```\nIn the second example the data that is logged is not sensitive.\n\n\n```javascript\nlet not_sensitive_data = { a: 1, b : 2} \n// GOOD: it is fine to log data that is not sensitive\nconsole.info(`[INFO] Some object contains: ${JSON.stringify(not_sensitive_data)}`);\n```\n\n## References\n* OWASP: [Insertion of Sensitive Information into Log File](https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/).\n* Common Weakness Enumeration: [CWE-312](https://cwe.mitre.org/data/definitions/312.html).\n* Common Weakness Enumeration: [CWE-359](https://cwe.mitre.org/data/definitions/359.html).\n* Common Weakness Enumeration: [CWE-532](https://cwe.mitre.org/data/definitions/532.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "This logs sensitive data returned by an access to api_key as clear text.\nThis logs sensitive data returned by an access to apiKey as clear text."
      },
      "location": {
        "path": "backend/lib/aiEngine/keyResolver.js",
        "start_line": 90,
        "end_line": 90,
        "start_column": 89,
        "end_column": 106
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/145/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 144,
    "created_at": "2025-12-28T15:48:20Z",
    "updated_at": "2025-12-28T15:48:20Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/144",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/144",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/identity-replacement",
      "severity": "warning",
      "description": "Replacement of a substring with itself",
      "name": "js/identity-replacement",
      "tags": ["correctness", "external/cwe/cwe-116", "security"],
      "full_description": "Replacing a substring with itself has no effect and may indicate a mistake.",
      "help": "# Replacement of a substring with itself\nReplacing a substring with itself has no effect and usually indicates a mistake, such as misspelling a backslash escape.\n\n\n## Recommendation\nExamine the string replacement to find and correct any typos.\n\n\n## Example\nThe following code snippet attempts to backslash-escape all double quotes in `raw` by replacing all instances of `\"` with `\\\"`:\n\n\n```javascript\nvar escaped = raw.replace(/\"/g, '\\\"');\n\n```\nHowever, the replacement string `'\\\"'` is actually the same as `'\"'`, with `\\\"` interpreted as an identity escape, so the replacement does nothing. Instead, the replacement string should be `'\\\\\"'`:\n\n\n```javascript\nvar escaped = raw.replace(/\"/g, '\\\\\"');\n\n```\n\n## References\n* Mozilla Developer Network: [String escape notation](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String#Escape_notation).\n* Common Weakness Enumeration: [CWE-116](https://cwe.mitre.org/data/definitions/116.html).\n",
      "security_severity_level": "medium"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": { "text": "This replaces 'supabase.co' with itself." },
      "location": {
        "path": "backend/scripts/create-admin.js",
        "start_line": 218,
        "end_line": 218,
        "start_column": 53,
        "end_column": 66
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/144/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 143,
    "created_at": "2025-12-28T15:48:20Z",
    "updated_at": "2025-12-28T15:48:20Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/143",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/143",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/polynomial-redos",
      "severity": "warning",
      "description": "Polynomial regular expression used on uncontrolled data",
      "name": "js/polynomial-redos",
      "tags": ["external/cwe/cwe-1333", "external/cwe/cwe-400", "external/cwe/cwe-730", "security"],
      "full_description": "A regular expression that can require polynomial time to match may be vulnerable to denial-of-service attacks.",
      "help": "# Polynomial regular expression used on uncontrolled data\nSome regular expressions take a long time to match certain input strings to the point where the time it takes to match a string of length *n* is proportional to *n<sup>k</sup>* or even *2<sup>n</sup>*. Such regular expressions can negatively affect performance, or even allow a malicious user to perform a Denial of Service (\"DoS\") attack by crafting an expensive input string for the regular expression to match.\n\nThe regular expression engines provided by many popular JavaScript platforms use backtracking non-deterministic finite automata to implement regular expression matching. While this approach is space-efficient and allows supporting advanced features like capture groups, it is not time-efficient in general. The worst-case time complexity of such an automaton can be polynomial or even exponential, meaning that for strings of a certain shape, increasing the input length by ten characters may make the automaton about 1000 times slower.\n\nTypically, a regular expression is affected by this problem if it contains a repetition of the form `r*` or `r+` where the sub-expression `r` is ambiguous in the sense that it can match some string in multiple ways. More information about the precise circumstances can be found in the references.\n\n\n## Recommendation\nModify the regular expression to remove the ambiguity, or ensure that the strings matched with the regular expression are short enough that the time-complexity does not matter.\n\n\n## Example\nConsider this use of a regular expression, which removes all leading and trailing whitespace in a string:\n\n```javascript\n\ntext.replace(/^\\s+|\\s+$/g, ''); // BAD\n```\nThe sub-expression `\"\\s+$\"` will match the whitespace characters in `text` from left to right, but it can start matching anywhere within a whitespace sequence. This is problematic for strings that do **not** end with a whitespace character. Such a string will force the regular expression engine to process each whitespace sequence once per whitespace character in the sequence.\n\nThis ultimately means that the time cost of trimming a string is quadratic in the length of the string. So a string like `\"a b\"` will take milliseconds to process, but a similar string with a million spaces instead of just one will take several minutes.\n\nAvoid this problem by rewriting the regular expression to not contain the ambiguity about when to start matching whitespace sequences. For instance, by using a negative look-behind (`/^\\s+|(?<!\\s)\\s+$/g`), or just by using the built-in trim method (`text.trim()`).\n\nNote that the sub-expression `\"^\\s+\"` is **not** problematic as the `^` anchor restricts when that sub-expression can start matching, and as the regular expression engine matches from left to right.\n\n\n## Example\nAs a similar, but slightly subtler problem, consider the regular expression that matches lines with numbers, possibly written using scientific notation:\n\n```javascript\n\n/^0\\.\\d+E?\\d+$/.test(str) // BAD\n```\nThe problem with this regular expression is in the sub-expression `\\d+E?\\d+` because the second `\\d+` can start matching digits anywhere after the first match of the first `\\d+` if there is no `E` in the input string.\n\nThis is problematic for strings that do **not** end with a digit. Such a string will force the regular expression engine to process each digit sequence once per digit in the sequence, again leading to a quadratic time complexity.\n\nTo make the processing faster, the regular expression should be rewritten such that the two `\\d+` sub-expressions do not have overlapping matches: `^0\\.\\d+(E\\d+)?$`.\n\n\n## Example\nSometimes it is unclear how a regular expression can be rewritten to avoid the problem. In such cases, it often suffices to limit the length of the input string. For instance, the following regular expression is used to match numbers, and on some non-number inputs it can have quadratic time complexity:\n\n```javascript\n\n/^(\\+|-)?(\\d+|(\\d*\\.\\d*))?(E|e)?([-+])?(\\d+)?$/.test(str) // BAD\n```\nIt is not immediately obvious how to rewrite this regular expression to avoid the problem. However, you can mitigate performance issues by limiting the length to 1000 characters, which will always finish in a reasonable amount of time.\n\n```javascript\n\nif (str.length > 1000) {\n    throw new Error(\"Input too long\");\n}\n\n/^(\\+|-)?(\\d+|(\\d*\\.\\d*))?(E|e)?([-+])?(\\d+)?$/.test(str)\n```\n\n## References\n* OWASP: [Regular expression Denial of Service - ReDoS](https://www.owasp.org/index.php/Regular_expression_Denial_of_Service_-_ReDoS).\n* Wikipedia: [ReDoS](https://en.wikipedia.org/wiki/ReDoS).\n* Wikipedia: [Time complexity](https://en.wikipedia.org/wiki/Time_complexity).\n* James Kirrage, Asiri Rathnayake, Hayo Thielecke: [Static Analysis for Regular Expression Denial-of-Service Attack](https://arxiv.org/abs/1301.0849).\n* Common Weakness Enumeration: [CWE-1333](https://cwe.mitre.org/data/definitions/1333.html).\n* Common Weakness Enumeration: [CWE-730](https://cwe.mitre.org/data/definitions/730.html).\n* Common Weakness Enumeration: [CWE-400](https://cwe.mitre.org/data/definitions/400.html).\n",
      "security_severity_level": "high"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": {
        "text": "This regular expression that depends on a user-provided value may run slow on strings starting with 'send ' and with many repetitions of '\\t\\t'.\nThis regular expression that depends on a user-provided value may run slow on strings starting with 'send ' and with many repetitions of '\\t\\t'."
      },
      "location": {
        "path": "backend/lib/callFlowHandler.js",
        "start_line": 1405,
        "end_line": 1405,
        "start_column": 19,
        "end_column": 88
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/143/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 141,
    "created_at": "2025-12-28T15:48:20Z",
    "updated_at": "2025-12-28T15:48:20Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/141",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/141",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/request-forgery",
      "severity": "error",
      "description": "Server-side request forgery",
      "name": "js/request-forgery",
      "tags": ["external/cwe/cwe-918", "security"],
      "full_description": "Making a network request with user-controlled data in the URL allows for request forgery attacks.",
      "help": "# Server-side request forgery\nDirectly incorporating user input in the URL of an outgoing HTTP request can enable a request forgery attack, in which the request is altered to target an unintended API endpoint or resource. If the server performing the request is connected to an internal network, this can give an attacker the means to bypass the network boundary and make requests against internal services. A forged request may perform an unintended action on behalf of the attacker, or cause information leak if redirected to an external server or if the request response is fed back to the user. It may also compromise the server making the request, if the request response is handled in an unsafe way.\n\n\n## Recommendation\nRestrict user inputs in the URL of an outgoing request, in particular:\n\n* Avoid user input in the hostname of the URL. Pick the hostname from an allow-list instead of constructing it directly from user input.\n* Take care when user input is part of the pathname of the URL. Restrict the input so that path traversal (\"`../`\") cannot be used to redirect the request to an unintended endpoint.\n\n## Example\nThe following example shows an HTTP request parameter being used directly in the URL of a request without validating the input, which facilitates an SSRF attack. The request `http.get(...)` is vulnerable since attackers can choose the value of `target` to be anything they want. For instance, the attacker can choose `\"internal.example.com/#\"` as the target, causing the URL used in the request to be `\"https://internal.example.com/#.example.com/data\"`.\n\nA request to `https://internal.example.com` may be problematic if that server is not meant to be directly accessible from the attacker's machine.\n\n\n```javascript\nimport http from 'http';\n\nconst server = http.createServer(function(req, res) {\n    const target = new URL(req.url, \"http://example.com\").searchParams.get(\"target\");\n\n    // BAD: `target` is controlled by the attacker\n    http.get('https://' + target + \".example.com/data/\", res => {\n        // process request response ...\n    });\n\n});\n\n```\nOne way to remedy the problem is to use the user input to select a known fixed string before performing the request:\n\n\n```javascript\nimport http from 'http';\n\nconst server = http.createServer(function(req, res) {\n    const target = new URL(req.url, \"http://example.com\").searchParams.get(\"target\");\n\n    let subdomain;\n    if (target === 'EU') {\n        subdomain = \"europe\"\n    } else {\n        subdomain = \"world\"\n    }\n\n    // GOOD: `subdomain` is controlled by the server\n    http.get('https://' + subdomain + \".example.com/data/\", res => {\n        // process request response ...\n    });\n\n});\n\n```\n\n## References\n* OWASP: [SSRF](https://www.owasp.org/index.php/Server_Side_Request_Forgery)\n* Common Weakness Enumeration: [CWE-918](https://cwe.mitre.org/data/definitions/918.html).\n",
      "security_severity_level": "critical"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": { "text": "The URL of this request depends on a user-provided value." },
      "location": {
        "path": "backend/routes/testing.js",
        "start_line": 513,
        "end_line": 513,
        "start_column": 32,
        "end_column": 53
      },
      "classifications": ["test"]
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/141/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 140,
    "created_at": "2025-12-28T15:48:20Z",
    "updated_at": "2025-12-28T15:48:20Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/140",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/140",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/request-forgery",
      "severity": "error",
      "description": "Server-side request forgery",
      "name": "js/request-forgery",
      "tags": ["external/cwe/cwe-918", "security"],
      "full_description": "Making a network request with user-controlled data in the URL allows for request forgery attacks.",
      "help": "# Server-side request forgery\nDirectly incorporating user input in the URL of an outgoing HTTP request can enable a request forgery attack, in which the request is altered to target an unintended API endpoint or resource. If the server performing the request is connected to an internal network, this can give an attacker the means to bypass the network boundary and make requests against internal services. A forged request may perform an unintended action on behalf of the attacker, or cause information leak if redirected to an external server or if the request response is fed back to the user. It may also compromise the server making the request, if the request response is handled in an unsafe way.\n\n\n## Recommendation\nRestrict user inputs in the URL of an outgoing request, in particular:\n\n* Avoid user input in the hostname of the URL. Pick the hostname from an allow-list instead of constructing it directly from user input.\n* Take care when user input is part of the pathname of the URL. Restrict the input so that path traversal (\"`../`\") cannot be used to redirect the request to an unintended endpoint.\n\n## Example\nThe following example shows an HTTP request parameter being used directly in the URL of a request without validating the input, which facilitates an SSRF attack. The request `http.get(...)` is vulnerable since attackers can choose the value of `target` to be anything they want. For instance, the attacker can choose `\"internal.example.com/#\"` as the target, causing the URL used in the request to be `\"https://internal.example.com/#.example.com/data\"`.\n\nA request to `https://internal.example.com` may be problematic if that server is not meant to be directly accessible from the attacker's machine.\n\n\n```javascript\nimport http from 'http';\n\nconst server = http.createServer(function(req, res) {\n    const target = new URL(req.url, \"http://example.com\").searchParams.get(\"target\");\n\n    // BAD: `target` is controlled by the attacker\n    http.get('https://' + target + \".example.com/data/\", res => {\n        // process request response ...\n    });\n\n});\n\n```\nOne way to remedy the problem is to use the user input to select a known fixed string before performing the request:\n\n\n```javascript\nimport http from 'http';\n\nconst server = http.createServer(function(req, res) {\n    const target = new URL(req.url, \"http://example.com\").searchParams.get(\"target\");\n\n    let subdomain;\n    if (target === 'EU') {\n        subdomain = \"europe\"\n    } else {\n        subdomain = \"world\"\n    }\n\n    // GOOD: `subdomain` is controlled by the server\n    http.get('https://' + subdomain + \".example.com/data/\", res => {\n        // process request response ...\n    });\n\n});\n\n```\n\n## References\n* OWASP: [SSRF](https://www.owasp.org/index.php/Server_Side_Request_Forgery)\n* Common Weakness Enumeration: [CWE-918](https://cwe.mitre.org/data/definitions/918.html).\n",
      "security_severity_level": "critical"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": { "text": "The URL of this request depends on a user-provided value." },
      "location": {
        "path": "backend/routes/testing.js",
        "start_line": 370,
        "end_line": 370,
        "start_column": 33,
        "end_column": 88
      },
      "classifications": ["test"]
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/140/instances",
    "dismissal_approved_by": null,
    "assignees": []
  },
  {
    "number": 139,
    "created_at": "2025-12-28T15:48:20Z",
    "updated_at": "2025-12-28T15:48:20Z",
    "url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/139",
    "html_url": "https://github.com/andreibyf/aishacrm-2/security/code-scanning/139",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "js/request-forgery",
      "severity": "error",
      "description": "Server-side request forgery",
      "name": "js/request-forgery",
      "tags": ["external/cwe/cwe-918", "security"],
      "full_description": "Making a network request with user-controlled data in the URL allows for request forgery attacks.",
      "help": "# Server-side request forgery\nDirectly incorporating user input in the URL of an outgoing HTTP request can enable a request forgery attack, in which the request is altered to target an unintended API endpoint or resource. If the server performing the request is connected to an internal network, this can give an attacker the means to bypass the network boundary and make requests against internal services. A forged request may perform an unintended action on behalf of the attacker, or cause information leak if redirected to an external server or if the request response is fed back to the user. It may also compromise the server making the request, if the request response is handled in an unsafe way.\n\n\n## Recommendation\nRestrict user inputs in the URL of an outgoing request, in particular:\n\n* Avoid user input in the hostname of the URL. Pick the hostname from an allow-list instead of constructing it directly from user input.\n* Take care when user input is part of the pathname of the URL. Restrict the input so that path traversal (\"`../`\") cannot be used to redirect the request to an unintended endpoint.\n\n## Example\nThe following example shows an HTTP request parameter being used directly in the URL of a request without validating the input, which facilitates an SSRF attack. The request `http.get(...)` is vulnerable since attackers can choose the value of `target` to be anything they want. For instance, the attacker can choose `\"internal.example.com/#\"` as the target, causing the URL used in the request to be `\"https://internal.example.com/#.example.com/data\"`.\n\nA request to `https://internal.example.com` may be problematic if that server is not meant to be directly accessible from the attacker's machine.\n\n\n```javascript\nimport http from 'http';\n\nconst server = http.createServer(function(req, res) {\n    const target = new URL(req.url, \"http://example.com\").searchParams.get(\"target\");\n\n    // BAD: `target` is controlled by the attacker\n    http.get('https://' + target + \".example.com/data/\", res => {\n        // process request response ...\n    });\n\n});\n\n```\nOne way to remedy the problem is to use the user input to select a known fixed string before performing the request:\n\n\n```javascript\nimport http from 'http';\n\nconst server = http.createServer(function(req, res) {\n    const target = new URL(req.url, \"http://example.com\").searchParams.get(\"target\");\n\n    let subdomain;\n    if (target === 'EU') {\n        subdomain = \"europe\"\n    } else {\n        subdomain = \"world\"\n    }\n\n    // GOOD: `subdomain` is controlled by the server\n    http.get('https://' + subdomain + \".example.com/data/\", res => {\n        // process request response ...\n    });\n\n});\n\n```\n\n## References\n* OWASP: [SSRF](https://www.owasp.org/index.php/Server_Side_Request_Forgery)\n* Common Weakness Enumeration: [CWE-918](https://cwe.mitre.org/data/definitions/918.html).\n",
      "security_severity_level": "critical"
    },
    "tool": { "name": "CodeQL", "guid": null, "version": "2.24.2" },
    "most_recent_instance": {
      "ref": "refs/heads/main",
      "analysis_key": ".github/workflows/codeql.yml:analyze-default",
      "environment": "{}",
      "category": "/language:javascript",
      "state": "open",
      "commit_sha": "60de0faa120eea43cfec5f0340a0de728caf0f5b",
      "message": { "text": "The URL of this request depends on a user-provided value." },
      "location": {
        "path": "backend/routes/reports.js",
        "start_line": 2145,
        "end_line": 2145,
        "start_column": 39,
        "end_column": 67
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/andreibyf/aishacrm-2/code-scanning/alerts/139/instances",
    "dismissal_approved_by": null,
    "assignees": []
  }
]
